# ๐ข ูุฏููู ุงูุฃุตูู ุงูุซุงุจุชุฉ - Fixed Assets Module
## ุงูุชุญููู ุงูุชูุตููู ุงููุงูู ูุงููุนูุงุฑู

---

## ๐ ุฌุฏูู ุงููุญุชููุงุช

1. [ูุธุฑุฉ ุนุงูุฉ](#overview)
2. [ุงูููุงูุงุช ุงูุฃุณุงุณูุฉ](#entities)
3. [ุฏูุฑุฉ ุงูุนูู ุงููุงููุฉ](#workflow)
4. [ุงูุดุงุดุงุช ุงูุชูุตูููุฉ](#screens)
5. [ุงูุชูุงูู ูุน ุงููุฏูููุงุช](#integration)
6. [ููุงุนุฏ ุงูุนูู](#business-rules)
7. [Database Schema](#database)
8. [APIs ุงููุทููุจุฉ](#apis)
9. [ุงูุฃูุซูุฉ ุงูุนูููุฉ](#examples)

---

<a name="overview"></a>
## ๐ฏ 1. ูุธุฑุฉ ุนุงูุฉ ุนูู ุงููุฏููู

### ุงููุฏู ุงูุฑุฆูุณู
ูุฏููู ุงูุฃุตูู ุงูุซุงุจุชุฉ ูุณุคูู ุนู ุฅุฏุงุฑุฉ ุฏูุฑุฉ ุญูุงุฉ ุงูุฃุตูู ุงููุงููุฉ ูู ูุญุธุฉ ุงูุงูุชูุงุก ุญุชู ุงูุชุฎูุต ูููุงุ ููุดูู:
- ุฅุฏุงุฑุฉ ุงูุฃุตูู ุงูุซุงุจุชุฉ
- ุงูุงูุชูุงุก (ุดุฑุงุกุ ุชุญููู ูู ุฃุตูู ุชุญุช ุงูุชุดุบููุ ูุจุงุช)
- ุงูุฅููุงู ุจุทุฑู ูุชุนุฏุฏุฉ
- ุงูุตูุงูุฉ ูุงูุฅุตูุงุญุงุช
- ุฅุนุงุฏุฉ ุงูุชูููู
- ุงูููู ุจูู ุงูููุงูุน
- ุงูุจูุน ูุงูุชุฎุฑูุฏ
- ุงูุฌุฑุฏ ุงูุฏูุฑู
- ุชูุงุฑูุฑ ุชูุตูููุฉ

### ุงููุทุงู (Scope)
- โ ุฅุฏุงุฑุฉ ุฏูุฑุฉ ุญูุงุฉ ุงูุฃุตู ุงููุงููุฉ
- โ ุทุฑู ุฅููุงู ูุชุนุฏุฏุฉ (ูุณุท ุซุงุจุชุ ูุชูุงูุตุ ูุญุฏุงุช ุฅูุชุงุฌ)
- โ ุงูุฅููุงู ุงูุถุฑูุจู ูุงููุญุงุณุจู ุงููููุตู
- โ ุชุญููู ุฃุตูู ุชุญุช ุงูุชุดุบูู โ ุฃุตูู ุซุงุจุชุฉ
- โ ุงูุตูุงูุฉ ุงูููุงุฆูุฉ ูุงูุชุตุญูุญูุฉ
- โ ุฅุนุงุฏุฉ ุงูุชูููู ูุงูุชุญุณููุงุช
- โ ุงูุจูุน ูุงูุชุฎุฑูุฏ
- โ Multi-Location & Multi-Company
- โ ุงูุชุชุจุน ุจุงูุจุงุฑููุฏ/RFID
- โ ุงูุฌุฑุฏ ูุงูุชุณููุงุช

### ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ
1. **ุฅุฏุงุฑุฉ ูุชูุฏูุฉ ููุฃุตูู**
   - ุชุตููู ูุฑูู ููุฃุตูู
   - ุชุชุจุน ุชูุตููู ููู ุฃุตู
   - ุฅุฏุงุฑุฉ ุงูููุงุตูุงุช ูุงููุณุชูุฏุงุช
   - ุชุงุฑูุฎ ูุงูู ููุฃุตู

2. **ูุธุงู ุฅููุงู ุดุงูู**
   - ุทุฑู ุฅููุงู ูุชุนุฏุฏุฉ
   - ุงุญุชุณุงุจ ุขูู ุดูุฑู/ุณููู
   - ุฅููุงู ูุญุงุณุจู ูุถุฑูุจู ูููุตู
   - ูุนุงูุฌุฉ ุงูุฅููุงู ุงููุชุฑุงูู

3. **ุฅุฏุงุฑุฉ ุงูุตูุงูุฉ**
   - ุตูุงูุฉ ููุงุฆูุฉ ูุฌุฏููุฉ
   - ุตูุงูุฉ ุชุตุญูุญูุฉ
   - ุชุชุจุน ุชูุงููู ุงูุตูุงูุฉ
   - ุชุงุฑูุฎ ุงูุตูุงูุฉ

4. **ุงูุนูููุงุช ุงููุงููุฉ**
   - ุงูุดุฑุงุก ูุงูุจูุน
   - ุฅุนุงุฏุฉ ุงูุชูููู
   - ุงูุชุญุณููุงุช ุงูุฑุฃุณูุงููุฉ
   - ูุนุงูุฌุฉ ุงูุฑุจุญ/ุงูุฎุณุงุฑุฉ

---

<a name="entities"></a>
## ๐ 2. ุงูููุงูุงุช ุงูุฃุณุงุณูุฉ

### 2.1 Asset (ุงูุฃุตู)
ุงูููุงู ุงูุฑุฆูุณู ุงูุฐู ููุซู ุงูุฃุตู ุงูุซุงุจุช ููุณู

**ุงูุฎุตุงุฆุต ุงูุฑุฆูุณูุฉ:**
- ูุนูููุงุช ุงูุฃุตู ุงูุฃุณุงุณูุฉ (ุงูููุฏุ ุงูุงุณูุ ุงููุตู)
- ุงูุชุตููู (ูุฆุฉุ ููุนุ ูุฌููุนุฉ)
- ูุนูููุงุช ุงูุงูุชูุงุก (ุงูุชุงุฑูุฎุ ุงูุชูููุฉุ ุงูููุฑุฏ)
- ูุนูููุงุช ุงูุฅููุงู (ุงูุทุฑููุฉุ ุงููุนุฏูุ ุงูุนูุฑ ุงูุฅูุชุงุฌู)
- ุงููููุน ูุงูุญุงูุฉ
- ุงูููู ุงููุงููุฉ (ุงูุชูููุฉุ ุงูุฅููุงู ุงููุชุฑุงููุ ุงููููุฉ ุงูุฏูุชุฑูุฉ)

**ุงูุญุงูุงุช (States):**
- Draft (ูุณูุฏุฉ)
- Under Construction (ุชุญุช ุงูุชุดุบูู)
- Active (ูุดุท)
- Under Maintenance (ุชุญุช ุงูุตูุงูุฉ)
- Disposed (ุชู ุงูุชุฎูุต ููู)
- Sold (ูุจุงุน)
- Written Off (ูุดุทูุจ)

### 2.2 Asset Category (ูุฆุฉ ุงูุฃุตู)
ุชุตููู ุงูุฃุตูู ุฅูู ูุฆุงุช

**ุฃูุซูุฉ:**
- ุงููุจุงูู ูุงูุฅูุดุงุกุงุช
- ุงูุฃุซุงุซ ูุงูุชุฌููุฒุงุช
- ุงููุนุฏุงุช ูุงูุขูุงุช
- ุงูุณูุงุฑุงุช ูุงููุฑูุจุงุช
- ุงูุฃุฌูุฒุฉ ุงูุฅููุชุฑูููุฉ
- ุงูุจุฑูุฌูุงุช

**ูู ูุฆุฉ ุชุญุชูู ุนูู:**
- ุทุฑููุฉ ุงูุฅููุงู ุงูุงูุชุฑุงุถูุฉ
- ูุนุฏู ุงูุฅููุงู
- ุงูุนูุฑ ุงูุฅูุชุงุฌู
- ุงูุญุณุงุจุงุช ุงููุญุงุณุจูุฉ ุงููุฑุชุจุทุฉ

### 2.3 Depreciation (ุงูุฅููุงู)
ุณุฌู ุนูููุงุช ุงูุฅููุงู

**ุฃููุงุน:**
- Accounting Depreciation (ุฅููุงู ูุญุงุณุจู)
- Tax Depreciation (ุฅููุงู ุถุฑูุจู)

**ุงูุทุฑู:**
- Straight Line (ุงููุณุท ุงูุซุงุจุช)
- Declining Balance (ุงููุณุท ุงููุชูุงูุต)
- Units of Production (ูุญุฏุงุช ุงูุฅูุชุงุฌ)
- Sum of Years Digits (ูุฌููุน ุฃุฑูุงู ุงูุณููุงุช)

### 2.4 Asset Maintenance (ุตูุงูุฉ ุงูุฃุตู)
ุณุฌู ุนูููุงุช ุงูุตูุงูุฉ

**ุงูุฃููุงุน:**
- Preventive (ููุงุฆูุฉ)
- Corrective (ุชุตุญูุญูุฉ)
- Predictive (ุชูุจุคูุฉ)
- Emergency (ุทุงุฑุฆุฉ)

### 2.5 Asset Transfer (ููู ุงูุฃุตู)
ุณุฌู ููู ุงูุฃุตูู ุจูู ุงูููุงูุน

### 2.6 Asset Revaluation (ุฅุนุงุฏุฉ ุชูููู ุงูุฃุตู)
ุณุฌู ุฅุนุงุฏุฉ ุชูููู ุงูุฃุตูู

### 2.7 Asset Disposal (ุงูุชุฎูุต ูู ุงูุฃุตู)
ุณุฌู ุจูุน ุฃู ุชุฎุฑูุฏ ุงูุฃุตูู

---

<a name="workflow"></a>
## ๐ 3. ุฏูุฑุฉ ุงูุนูู ุงููุงููุฉ

### ุงููุณุงุฑ ุงูุฃุณุงุณู: ุฏูุฑุฉ ุญูุงุฉ ุงูุฃุตู

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    ุฏูุฑุฉ ุญูุงุฉ ุงูุฃุตู ุงูุซุงุจุช                      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

1๏ธโฃ ุงูุงูุชูุงุก (Acquisition)
   โโโ ุดุฑุงุก ูุจุงุดุฑ
   โโโ ุชุญููู ูู ุฃุตูู ุชุญุช ุงูุชุดุบูู
   โโโ ูุจุงุช/ุชุจุฑุนุงุช
   โโโ ุฅูุฌุงุฑ ุชููููู
              โ
2๏ธโฃ ุงูุชูุนูู (Activation)
   โโโ ุชุณุฌูู ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ
   โโโ ุชุญุฏูุฏ ุทุฑููุฉ ุงูุฅููุงู
   โโโ ุชุนููู ุงููููุน ูุงููุณุชุฎุฏู
   โโโ ุงูุจุฏุก ูู ุงูุฅููุงู
              โ
3๏ธโฃ ุงูุชุดุบูู (Operation)
   โโโ ุงูุฅููุงู ุงูุฏูุฑู
   โโโ ุงูุตูุงูุฉ ูุงูุฅุตูุงุญุงุช
   โโโ ุงูููู ุจูู ุงูููุงูุน
   โโโ ุงูุชุญุณููุงุช ูุงูุฅุถุงูุงุช
              โ
4๏ธโฃ ุฅุนุงุฏุฉ ุงูุชูููู (Revaluation)
   โโโ ุฒูุงุฏุฉ ุงููููุฉ
   โโโ ุชุฎููุถ ุงููููุฉ
   โโโ ุชุนุฏูู ุงูุฅููุงู
              โ
5๏ธโฃ ุงูุชุฎูุต (Disposal)
   โโโ ุงูุจูุน
   โโโ ุงูุชุฎุฑูุฏ
   โโโ ุงูุดุทุจ
```

### 3.1 ูุณุงุฑ ุงูุงูุชูุงุก (Acquisition Flow)

```
๐ฆ ุดุฑุงุก ุฃุตู ุฌุฏูุฏ
    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  1. ุฃูุฑ ุดุฑุงุก            โ โ ูู ูุฏููู ุงููุดุชุฑูุงุช
โ     Purchase Order      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  2. ุงุณุชูุงู ุงูุฃุตู        โ
โ     GRN                 โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  3. ูุงุชูุฑุฉ ุงูุดุฑุงุก       โ
โ     Purchase Invoice    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  4. ุชุณุฌูู ุงูุฃุตู         โ
โ     Asset Registration  โ
โ     - ุงูุชูููุฉ          โ
โ     - ุงููููุน          โ
โ     - ุงููุณุชุฎุฏู        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  5. ุจุฏุก ุงูุฅููุงู        โ
โ     Start Depreciation  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโ

ุงูููุฏ ุงููุญุงุณุจู:
Dr. Fixed Assets          xxx
    Cr. Accounts Payable      xxx
```

### 3.2 ูุณุงุฑ ุชุญููู ุฃุตูู ุชุญุช ุงูุชุดุบูู

```
๐๏ธ ูุดุฑูุน ููุฏ ุงูุชูููุฐ
    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ุฃุตูู ุชุญุช ุงูุชุดุบูู               โ
โ  Assets Under Construction      โ
โ  (CIP - Construction in         โ
โ   Progress)                     โ
โ                                 โ
โ  - ุชูุงููู ูุจุงุดุฑุฉ               โ
โ  - ุชูุงููู ุบูุฑ ูุจุงุดุฑุฉ           โ
โ  - ุชูุงููู ุงูุชูููู              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ุงูุชูุงู ุงููุดุฑูุน                โ
โ  Project Completion             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ุชุญููู โ ุฃุตู ุซุงุจุช               โ
โ  Transfer to Fixed Asset        โ
โ                                 โ
โ  - ุชุฌููุน ุงูุชูุงููู              โ
โ  - ุชูุฒูุน ุนูู ุงูุฃุตูู            โ
โ  - ุชุณุฌูู ุงูุฃุตู ุงูุฌุฏูุฏ           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ุจุฏุก ุงูุฅููุงู                   โ
โ  Start Depreciation             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

ุงูููุฏ ุงููุญุงุณุจู:
Dr. Fixed Assets - Building    xxx
    Cr. CIP - Building Project     xxx
```

### 3.3 ูุณุงุฑ ุงูุฅููุงู (Depreciation Flow)

```
๐ ููุงูุฉ ุงูุดูุฑ/ุงูุณูุฉ
    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  Depreciation Service            โ
โ  (ุฎุฏูุฉ ุงูุฅููุงู ุงูุขููุฉ)          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  1. ุฌูุจ ุงูุฃุตูู ุงููุงุจูุฉ ููุฅููุงู  โ
โ     - Active Status              โ
โ     - StartDate <= CurrentDate   โ
โ     - Not Fully Depreciated      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  2. ุญุณุงุจ ุงูุฅููุงู ููู ุฃุตู        โ
โ     - ุญุณุจ ุงูุทุฑููุฉ ุงููุญุฏุฏุฉ       โ
โ     - ุงููุญุงุณุจู ูุงูุถุฑูุจู         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  3. ุฅูุดุงุก ุณุฌูุงุช ุงูุฅููุงู         โ
โ     Depreciation Entries         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  4. ุชุฑุญูู ูููุญุงุณุจุฉ              โ
โ     Post to Accounting           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

ุงูููุฏ ุงููุญุงุณุจู:
Dr. Depreciation Expense      xxx
    Cr. Accumulated Depreciation  xxx
```

### 3.4 ูุณุงุฑ ุงูุตูุงูุฉ (Maintenance Flow)

```
๐ง ุทูุจ ุตูุงูุฉ
    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  1. ุฅูุดุงุก ุฃูุฑ ุตูุงูุฉ      โ
โ     Maintenance Order    โ
โ     - ุงูููุน             โ
โ     - ุงูุฃููููุฉ          โ
โ     - ุงููุตู            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  2. ุงูุชุฎุตูุต              โ
โ     Assignment           โ
โ     - ุงูููู             โ
โ     - ุงูููุนุฏ           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  3. ุงูุชูููุฐ             โ
โ     Execution           โ
โ     - ูุทุน ุงูุบูุงุฑ       โ
โ     - ุณุงุนุงุช ุงูุนูู      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  4. ุงูุฅูุฌุงุฒ             โ
โ     Completion          โ
โ     - ุชูุฑูุฑ ุงูุตูุงูุฉ    โ
โ     - ุงูุชูุงููู         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  5. ุงูููุฏ ุงููุญุงุณุจู      โ
โ     Accounting Entry    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโ

ุฅุฐุง ูุงูุช ุตูุงูุฉ ุนุงุฏูุฉ:
Dr. Maintenance Expense       xxx
    Cr. Cash/Inventory/AP        xxx

ุฅุฐุง ูุงูุช ุชุญุณูู ุฑุฃุณูุงูู:
Dr. Fixed Assets              xxx
    Cr. Cash/Inventory/AP        xxx
```

### 3.5 ูุณุงุฑ ุงูุจูุน (Sale/Disposal Flow)

```
๐ฐ ูุฑุงุฑ ุจูุน ุงูุฃุตู
    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  1. ุชูููู ุงูุฃุตู             โ
โ     - ุงููููุฉ ุงูุฏูุชุฑูุฉ      โ
โ     - ุงูุฅููุงู ุงููุชุฑุงูู     โ
โ     - ุณุนุฑ ุงูุจูุน ุงููุชููุน    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  2. ุงูููุงููุงุช               โ
โ     Approvals               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  3. ุฅููุงู ุงูุฅููุงู          โ
โ     Stop Depreciation       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  4. ุงูุจูุน                  โ
โ     - ูุงุชูุฑุฉ ุงูุจูุน         โ
โ     - ุชุญููู ุงูููููุฉ        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  5. ุญุณุงุจ ุงูุฑุจุญ/ุงูุฎุณุงุฑุฉ     โ
โ     Gain/Loss Calculation   โ
โ                             โ
โ     Sale Price              โ
โ     - Book Value            โ
โ     = Gain/Loss             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  6. ุงูููุฏ ุงููุญุงุณุจู         โ
โ     Accounting Entry        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

ุงูููุฏ:
Dr. Cash/AR                   xxx
Dr. Accumulated Depreciation  xxx
Dr. Loss on Sale             xxx (if loss)
    Cr. Fixed Assets             xxx
    Cr. Gain on Sale             xxx (if gain)
```

---

<a name="screens"></a>
## ๐ฅ๏ธ 4. ุงูุดุงุดุงุช ุงูุชูุตูููุฉ

### 4.1 ุดุงุดุฉ ุงูุฃุตู (Asset Screen)

```typescript
interface AssetScreen {
  // ุงูุชุจููุจุงุช
  tabs: [
    'General',        // ูุนูููุงุช ุนุงูุฉ
    'Financial',      // ูุนูููุงุช ูุงููุฉ
    'Depreciation',   // ุงูุฅููุงู
    'Maintenance',    // ุงูุตูุงูุฉ
    'Documents',      // ุงููุณุชูุฏุงุช
    'History'         // ุงูุชุงุฑูุฎ
  ];
  
  // Tab 1: General
  general: {
    sections: [
      {
        title: 'Basic Information',
        fields: [
          { name: 'code', type: 'text', required: true, readOnly: true },
          { name: 'nameAr', type: 'text', required: true },
          { name: 'nameEn', type: 'text', required: true },
          { name: 'categoryId', type: 'dropdown', required: true, lookup: 'AssetCategories' },
          { name: 'typeId', type: 'dropdown', lookup: 'AssetTypes' },
          { name: 'description', type: 'textarea' },
          { name: 'serialNumber', type: 'text' },
          { name: 'barcode', type: 'text' },
          { name: 'rfidTag', type: 'text' },
          { name: 'manufacturer', type: 'text' },
          { name: 'model', type: 'text' },
          { name: 'yearOfManufacture', type: 'number' }
        ]
      },
      {
        title: 'Location & Assignment',
        fields: [
          { name: 'companyId', type: 'dropdown', required: true },
          { name: 'branchId', type: 'dropdown' },
          { name: 'departmentId', type: 'dropdown' },
          { name: 'locationId', type: 'dropdown' },
          { name: 'roomNumber', type: 'text' },
          { name: 'assignedTo', type: 'dropdown', lookup: 'Employees' },
          { name: 'custodian', type: 'dropdown', lookup: 'Employees' }
        ]
      },
      {
        title: 'Status',
        fields: [
          { name: 'status', type: 'dropdown', required: true,
            options: ['Draft', 'Under Construction', 'Active', 'Under Maintenance', 'Disposed', 'Sold', 'Written Off']
          },
          { name: 'condition', type: 'dropdown',
            options: ['Excellent', 'Good', 'Fair', 'Poor', 'Critical']
          },
          { name: 'warrantyStartDate', type: 'date' },
          { name: 'warrantyEndDate', type: 'date' },
          { name: 'insurancePolicyNumber', type: 'text' },
          { name: 'insuranceExpiry', type: 'date' }
        ]
      }
    ]
  };
  
  // Tab 2: Financial
  financial: {
    sections: [
      {
        title: 'Acquisition',
        fields: [
          { name: 'acquisitionMethod', type: 'dropdown', required: true,
            options: ['Purchase', 'Transfer from CIP', 'Donation', 'Lease']
          },
          { name: 'acquisitionDate', type: 'date', required: true },
          { name: 'supplierId', type: 'dropdown', lookup: 'Suppliers' },
          { name: 'purchaseOrderId', type: 'dropdown', lookup: 'PurchaseOrders' },
          { name: 'purchaseInvoiceId', type: 'dropdown', lookup: 'PurchaseInvoices' },
          { name: 'originalCost', type: 'money', required: true },
          { name: 'currency', type: 'text' },
          { name: 'additionalCosts', type: 'money' },
          { name: 'totalCost', type: 'money', calculated: true }
        ]
      },
      {
        title: 'Current Value',
        fields: [
          { name: 'bookValue', type: 'money', readOnly: true },
          { name: 'accumulatedDepreciation', type: 'money', readOnly: true },
          { name: 'netBookValue', type: 'money', readOnly: true },
          { name: 'fairMarketValue', type: 'money' },
          { name: 'salvageValue', type: 'money' }
        ]
      },
      {
        title: 'Accounting',
        fields: [
          { name: 'assetAccountId', type: 'dropdown', required: true, lookup: 'ChartOfAccounts' },
          { name: 'depreciationAccountId', type: 'dropdown', required: true, lookup: 'ChartOfAccounts' },
          { name: 'accumulatedDepreciationAccountId', type: 'dropdown', required: true, lookup: 'ChartOfAccounts' },
          { name: 'costCenterId', type: 'dropdown', lookup: 'CostCenters' },
          { name: 'projectId', type: 'dropdown', lookup: 'Projects' }
        ]
      }
    ]
  };
  
  // Tab 3: Depreciation
  depreciation: {
    sections: [
      {
        title: 'Depreciation Settings',
        fields: [
          { name: 'depreciable', type: 'checkbox' },
          { name: 'depreciationMethod', type: 'dropdown',
            options: ['Straight Line', 'Declining Balance', 'Units of Production', 'Sum of Years Digits']
          },
          { name: 'usefulLife', type: 'number', suffix: 'years' },
          { name: 'usefulLifeMonths', type: 'number', suffix: 'months' },
          { name: 'depreciationRate', type: 'percentage' },
          { name: 'depreciationStartDate', type: 'date' },
          { name: 'salvageValue', type: 'money' },
          { name: 'totalUnitsToDepreciate', type: 'number' } // for Units of Production
        ]
      },
      {
        title: 'Tax Depreciation',
        fields: [
          { name: 'useTaxDepreciation', type: 'checkbox' },
          { name: 'taxDepreciationMethod', type: 'dropdown' },
          { name: 'taxUsefulLife', type: 'number' },
          { name: 'taxDepreciationRate', type: 'percentage' }
        ]
      },
      {
        title: 'Depreciation Summary',
        fields: [
          { name: 'totalDepreciation', type: 'money', readOnly: true },
          { name: 'yearToDateDepreciation', type: 'money', readOnly: true },
          { name: 'remainingDepreciation', type: 'money', readOnly: true },
          { name: 'fullyDepreciatedDate', type: 'date', readOnly: true }
        ]
      }
    ],
    
    // ุฌุฏูู ุณุฌูุงุช ุงูุฅููุงู
    grid: {
      title: 'Depreciation History',
      columns: [
        { field: 'period', header: 'Period', width: '100px' },
        { field: 'depreciationDate', header: 'Date', width: '120px' },
        { field: 'depreciationType', header: 'Type', width: '120px' },
        { field: 'depreciationAmount', header: 'Amount', width: '120px', align: 'right' },
        { field: 'accumulatedDepreciation', header: 'Accumulated', width: '120px', align: 'right' },
        { field: 'netBookValue', header: 'NBV', width: '120px', align: 'right' },
        { field: 'posted', header: 'Posted', width: '80px', type: 'boolean' }
      ],
      actions: ['view', 'reverse']
    }
  };
  
  // Tab 4: Maintenance
  maintenance: {
    grid: {
      title: 'Maintenance History',
      toolbar: {
        buttons: [
          { text: 'New Maintenance', icon: 'add', action: 'create' },
          { text: 'Schedule Preventive', icon: 'calendar', action: 'schedule' }
        ]
      },
      columns: [
        { field: 'code', header: 'Code', width: '120px' },
        { field: 'maintenanceDate', header: 'Date', width: '120px' },
        { field: 'maintenanceType', header: 'Type', width: '120px' },
        { field: 'description', header: 'Description', width: '200px' },
        { field: 'performedBy', header: 'Technician', width: '150px' },
        { field: 'cost', header: 'Cost', width: '120px', align: 'right' },
        { field: 'status', header: 'Status', width: '100px' }
      ],
      actions: ['view', 'edit', 'complete']
    }
  };
  
  // Tab 5: Documents
  documents: {
    sections: [
      {
        title: 'Attachments',
        component: 'FileUpload',
        allowedTypes: ['pdf', 'jpg', 'png', 'doc', 'docx', 'xls', 'xlsx'],
        maxSize: 10, // MB
        categories: [
          'Purchase Invoice',
          'Warranty Card',
          'Insurance Policy',
          'User Manual',
          'Specifications',
          'Photos',
          'Other'
        ]
      }
    ]
  };
  
  // Tab 6: History
  history: {
    grid: {
      title: 'Asset History',
      columns: [
        { field: 'transactionDate', header: 'Date', width: '120px' },
        { field: 'transactionType', header: 'Type', width: '150px' },
        { field: 'description', header: 'Description', width: '300px' },
        { field: 'amount', header: 'Amount', width: '120px', align: 'right' },
        { field: 'performedBy', header: 'User', width: '150px' }
      ]
    },
    
    timeline: {
      events: [
        'Acquisition',
        'Activation',
        'Transfer',
        'Revaluation',
        'Maintenance',
        'Depreciation',
        'Disposal'
      ]
    }
  };
  
  // Action Toolbar
  toolbar: {
    mainActions: [
      { text: 'Save', icon: 'save', action: 'save', shortcut: 'Ctrl+S' },
      { text: 'Post', icon: 'check', action: 'post', condition: 'status == Draft' },
      { text: 'Print', icon: 'print', action: 'print' },
      { text: 'Delete', icon: 'delete', action: 'delete', condition: 'status == Draft' }
    ],
    
    moreActions: [
      { text: 'Transfer', icon: 'swap', action: 'transfer', condition: 'status == Active' },
      { text: 'Revalue', icon: 'money', action: 'revalue', condition: 'status == Active' },
      { text: 'Create Maintenance', icon: 'build', action: 'maintenance' },
      { text: 'Calculate Depreciation', icon: 'calculate', action: 'depreciate' },
      { text: 'Sell', icon: 'sell', action: 'sell', condition: 'status == Active' },
      { text: 'Dispose', icon: 'delete-forever', action: 'dispose', condition: 'status == Active' },
      { text: 'Duplicate', icon: 'copy', action: 'duplicate' },
      { text: 'Export', icon: 'download', action: 'export' }
    ]
  };
}
```

### 4.2 ุดุงุดุฉ ูุฆุงุช ุงูุฃุตูู (Asset Categories Screen)

```typescript
interface AssetCategoryScreen {
  layout: 'master-detail';
  
  master: {
    title: 'Asset Categories',
    treeView: true,
    hierarchical: true,
    
    toolbar: {
      search: true,
      buttons: [
        { text: 'New Category', icon: 'add' },
        { text: 'New Sub-Category', icon: 'add-child' },
        { text: 'Expand All', icon: 'expand' },
        { text: 'Collapse All', icon: 'collapse' }
      ]
    },
    
    columns: [
      { field: 'code', header: 'Code', width: '100px' },
      { field: 'name', header: 'Name', width: '250px' },
      { field: 'depreciationMethod', header: 'Depreciation', width: '150px' },
      { field: 'usefulLife', header: 'Useful Life', width: '100px' },
      { field: 'assetCount', header: 'Assets', width: '80px', align: 'right' }
    ]
  };
  
  detail: {
    tabs: ['General', 'Depreciation', 'Accounting', 'Assets'];
    
    general: {
      fields: [
        { name: 'code', type: 'text', required: true },
        { name: 'nameAr', type: 'text', required: true },
        { name: 'nameEn', type: 'text', required: true },
        { name: 'parentCategoryId', type: 'dropdown', lookup: 'AssetCategories' },
        { name: 'description', type: 'textarea' },
        { name: 'isActive', type: 'checkbox' }
      ]
    };
    
    depreciation: {
      fields: [
        { name: 'defaultDepreciationMethod', type: 'dropdown', required: true },
        { name: 'defaultUsefulLife', type: 'number', suffix: 'years' },
        { name: 'defaultDepreciationRate', type: 'percentage' },
        { name: 'defaultSalvageValuePercentage', type: 'percentage' },
        { name: 'taxDepreciationMethod', type: 'dropdown' },
        { name: 'taxUsefulLife', type: 'number' }
      ]
    };
    
    accounting: {
      fields: [
        { name: 'assetAccountId', type: 'dropdown', lookup: 'ChartOfAccounts' },
        { name: 'depreciationAccountId', type: 'dropdown', lookup: 'ChartOfAccounts' },
        { name: 'accumulatedDepreciationAccountId', type: 'dropdown', lookup: 'ChartOfAccounts' },
        { name: 'disposalAccountId', type: 'dropdown', lookup: 'ChartOfAccounts' },
        { name: 'gainOnDisposalAccountId', type: 'dropdown', lookup: 'ChartOfAccounts' },
        { name: 'lossOnDisposalAccountId', type: 'dropdown', lookup: 'ChartOfAccounts' }
      ]
    };
    
    assets: {
      grid: {
        title: 'Assets in this Category',
        columns: [
          { field: 'code', header: 'Code' },
          { field: 'name', header: 'Name' },
          { field: 'acquisitionDate', header: 'Acquisition Date' },
          { field: 'cost', header: 'Cost' },
          { field: 'netBookValue', header: 'NBV' },
          { field: 'status', header: 'Status' }
        ]
      }
    }
  };
}
```

### 4.3 ุดุงุดุฉ ุงูุฅููุงู (Depreciation Screen)

```typescript
interface DepreciationScreen {
  // ุดุงุดุฉ ุชุดุบูู ุงูุฅููุงู ุงูุฏูุนู
  batchDepreciation: {
    wizard: {
      steps: [
        'Selection Criteria',
        'Preview & Calculate',
        'Review',
        'Post'
      ]
    };
    
    step1_criteria: {
      fields: [
        { name: 'depreciationPeriod', type: 'month-picker', required: true },
        { name: 'depreciationType', type: 'radio',
          options: ['Accounting', 'Tax', 'Both'],
          default: 'Accounting'
        },
        { name: 'categoryId', type: 'multiselect', lookup: 'AssetCategories' },
        { name: 'branchId', type: 'multiselect', lookup: 'Branches' },
        { name: 'includeNewAssets', type: 'checkbox', default: true },
        { name: 'excludeFullyDepreciated', type: 'checkbox', default: true }
      ],
      
      summary: {
        totalAssets: 0,
        totalCost: 0,
        estimatedDepreciation: 0
      }
    };
    
    step2_calculate: {
      grid: {
        selectable: true,
        columns: [
          { field: 'select', type: 'checkbox', width: '40px' },
          { field: 'assetCode', header: 'Asset Code', width: '120px' },
          { field: 'assetName', header: 'Asset Name', width: '200px' },
          { field: 'category', header: 'Category', width: '150px' },
          { field: 'method', header: 'Method', width: '120px' },
          { field: 'cost', header: 'Cost', width: '120px', align: 'right' },
          { field: 'accumulated', header: 'Accumulated', width: '120px', align: 'right' },
          { field: 'nbv', header: 'NBV', width: '120px', align: 'right' },
          { field: 'depreciation', header: 'Depreciation', width: '120px', align: 'right', editable: true },
          { field: 'newNbv', header: 'New NBV', width: '120px', align: 'right' }
        ]
      },
      
      footer: {
        totalDepreciation: 0,
        selectedAssets: 0
      }
    };
    
    step3_review: {
      summary: {
        period: '',
        assetsCount: 0,
        totalDepreciation: 0,
        accountingEntries: []
      },
      
      validation: {
        checks: [
          'All selected assets are eligible',
          'No duplicate entries for the period',
          'Accounting entries are balanced',
          'No negative NBV values'
        ]
      }
    };
    
    step4_post: {
      options: {
        postToAccounting: true,
        generateReport: true,
        sendNotification: true
      },
      
      progress: {
        current: 0,
        total: 0,
        status: 'In Progress'
      }
    }
  };
  
  // ุดุงุดุฉ ุนุฑุถ ุณุฌูุงุช ุงูุฅููุงู
  depreciationHistory: {
    filters: {
      period: 'month-range',
      depreciationType: 'dropdown',
      categoryId: 'multiselect',
      status: 'dropdown'
    };
    
    grid: {
      groupBy: 'period',
      columns: [
        { field: 'period', header: 'Period', width: '100px' },
        { field: 'batchNumber', header: 'Batch', width: '120px' },
        { field: 'assetCount', header: 'Assets', width: '80px', align: 'right' },
        { field: 'totalDepreciation', header: 'Total', width: '120px', align: 'right' },
        { field: 'posted', header: 'Posted', width: '80px', type: 'boolean' },
        { field: 'postedDate', header: 'Posted Date', width: '120px' },
        { field: 'postedBy', header: 'Posted By', width: '150px' }
      ],
      
      actions: ['view', 'reverse', 'print', 'export']
    }
  };
}
```

### 4.4 ุดุงุดุฉ ุงูุตูุงูุฉ (Maintenance Screen)

```typescript
interface MaintenanceScreen {
  tabs: ['General', 'Parts & Labor', 'Schedule', 'Documents'];
  
  general: {
    sections: [
      {
        title: 'Maintenance Information',
        fields: [
          { name: 'code', type: 'text', required: true, readOnly: true },
          { name: 'assetId', type: 'dropdown', required: true, lookup: 'Assets' },
          { name: 'maintenanceType', type: 'dropdown', required: true,
            options: ['Preventive', 'Corrective', 'Predictive', 'Emergency']
          },
          { name: 'priority', type: 'dropdown',
            options: ['Low', 'Medium', 'High', 'Critical']
          },
          { name: 'scheduledDate', type: 'datetime' },
          { name: 'actualStartDate', type: 'datetime' },
          { name: 'actualEndDate', type: 'datetime' },
          { name: 'description', type: 'textarea', required: true },
          { name: 'problemDescription', type: 'textarea' },
          { name: 'workPerformed', type: 'textarea' }
        ]
      },
      {
        title: 'Assignment',
        fields: [
          { name: 'assignedTo', type: 'dropdown', lookup: 'Employees' },
          { name: 'assignedTeam', type: 'dropdown', lookup: 'Teams' },
          { name: 'requestedBy', type: 'dropdown', lookup: 'Employees' },
          { name: 'approvedBy', type: 'dropdown', lookup: 'Employees' }
        ]
      },
      {
        title: 'Status',
        fields: [
          { name: 'status', type: 'dropdown',
            options: ['Draft', 'Scheduled', 'In Progress', 'Completed', 'Cancelled']
          },
          { name: 'completionPercentage', type: 'percentage' }
        ]
      }
    ]
  };
  
  partsAndLabor: {
    sections: [
      {
        title: 'Parts Used',
        grid: {
          columns: [
            { field: 'lineNumber', header: '#', width: '50px' },
            { field: 'productId', header: 'Part', width: '200px', editable: true },
            { field: 'quantity', header: 'Qty', width: '100px', editable: true },
            { field: 'unitId', header: 'Unit', width: '100px' },
            { field: 'unitCost', header: 'Unit Cost', width: '120px', align: 'right' },
            { field: 'totalCost', header: 'Total', width: '120px', align: 'right' }
          ],
          actions: ['add', 'delete']
        }
      },
      {
        title: 'Labor',
        grid: {
          columns: [
            { field: 'lineNumber', header: '#', width: '50px' },
            { field: 'employeeId', header: 'Technician', width: '200px', editable: true },
            { field: 'hours', header: 'Hours', width: '100px', editable: true },
            { field: 'hourlyRate', header: 'Rate', width: '120px', align: 'right' },
            { field: 'totalCost', header: 'Total', width: '120px', align: 'right' }
          ],
          actions: ['add', 'delete']
        }
      },
      {
        title: 'Other Costs',
        fields: [
          { name: 'externalServiceCost', type: 'money' },
          { name: 'transportationCost', type: 'money' },
          { name: 'otherCosts', type: 'money' }
        ]
      },
      {
        title: 'Total Cost',
        summary: {
          partsCost: 0,
          laborCost: 0,
          otherCosts: 0,
          totalCost: 0
        }
      }
    ]
  };
  
  schedule: {
    fields: [
      { name: 'isRecurring', type: 'checkbox' },
      { name: 'frequency', type: 'dropdown',
        options: ['Daily', 'Weekly', 'Monthly', 'Quarterly', 'Yearly'],
        condition: 'isRecurring == true'
      },
      { name: 'interval', type: 'number', condition: 'isRecurring == true' },
      { name: 'startDate', type: 'date', condition: 'isRecurring == true' },
      { name: 'endDate', type: 'date', condition: 'isRecurring == true' },
      { name: 'nextMaintenanceDate', type: 'date', readOnly: true }
    ],
    
    calendar: {
      title: 'Scheduled Maintenance',
      view: ['month', 'week', 'day']
    }
  };
}
```

---

<a name="integration"></a>
## ๐ 5. ุงูุชูุงูู ูุน ุงููุฏูููุงุช ุงูุฃุฎุฑู

### 5.1 ุงูุชูุงูู ูุน ูุฏููู ุงููุดุชุฑูุงุช

```typescript
interface PurchasingIntegration {
  // ุนูุฏ ุดุฑุงุก ุฃุตู ุฌุฏูุฏ
  onPurchaseInvoicePosted: {
    trigger: 'PurchaseInvoice.Posted',
    condition: 'invoice.items.any(i => i.product.isFixedAsset == true)',
    
    action: async (invoice) => {
      for (const item of invoice.items.filter(i => i.product.isFixedAsset)) {
        // ุฅูุดุงุก ุฃุตู ุฌุฏูุฏ ุชููุงุฆูุงู ุฃู ุฑุจุท ุจุฃุตู ููุฌูุฏ
        await assetService.createFromPurchase({
          productId: item.productId,
          acquisitionDate: invoice.invoiceDate,
          originalCost: item.totalAmount,
          supplierId: invoice.supplierId,
          purchaseInvoiceId: invoice.id,
          categoryId: item.product.assetCategoryId,
          status: 'Draft'
        });
      }
    }
  };
  
  // ุงูุญุณุงุจุงุช ุงููุชุฃุซุฑุฉ
  accountingImpact: {
    // ุนูุฏ ุงุณุชูุงู ุงูุฃุตู
    onGRN: {
      debit: 'Assets Under Construction', // if CIP
      // or
      debit: 'Fixed Assets',
      credit: 'GRN Not Invoiced'
    };
    
    // ุนูุฏ ุงููุงุชูุฑุฉ
    onInvoice: {
      debit: 'GRN Not Invoiced',
      credit: 'Accounts Payable'
    }
  };
}
```

### 5.2 ุงูุชูุงูู ูุน ูุฏููู ุงูุญุณุงุจุงุช

```typescript
interface AccountingIntegration {
  // ูููุฏ ุงูุฃุตูู ุงูุซุงุจุชุฉ
  journalEntries: {
    // 1. ุงูุงูุชูุงุก
    acquisition: {
      debit: [
        {
          account: 'Fixed Assets - [Category]',
          amount: 'asset.totalCost',
          costCenter: 'asset.costCenterId'
        }
      ],
      credit: [
        {
          account: 'Accounts Payable' | 'Cash' | 'CIP',
          amount: 'asset.totalCost'
        }
      ]
    };
    
    // 2. ุงูุฅููุงู
    depreciation: {
      monthly: {
        debit: [
          {
            account: 'Depreciation Expense - [Category]',
            amount: 'depreciation.amount',
            costCenter: 'asset.costCenterId'
          }
        ],
        credit: [
          {
            account: 'Accumulated Depreciation - [Category]',
            amount: 'depreciation.amount'
          }
        ]
      }
    };
    
    // 3. ุงูุตูุงูุฉ
    maintenance: {
      revenue: {
        // ุตูุงูุฉ ุนุงุฏูุฉ (ูุตุฑูู)
        debit: [
          {
            account: 'Maintenance Expense',
            amount: 'maintenance.totalCost',
            costCenter: 'asset.costCenterId'
          }
        ],
        credit: [
          {
            account: 'Cash' | 'Accounts Payable' | 'Inventory',
            amount: 'maintenance.totalCost'
          }
        ]
      },
      
      capital: {
        // ุชุญุณูู ุฑุฃุณูุงูู (ูุถุงู ููุฃุตู)
        debit: [
          {
            account: 'Fixed Assets - [Category]',
            amount: 'improvement.cost',
            costCenter: 'asset.costCenterId'
          }
        ],
        credit: [
          {
            account: 'Cash' | 'Accounts Payable' | 'Inventory',
            amount: 'improvement.cost'
          }
        ]
      }
    };
    
    // 4. ุฅุนุงุฏุฉ ุงูุชูููู
    revaluation: {
      increase: {
        debit: [
          {
            account: 'Fixed Assets - [Category]',
            amount: 'revaluation.increaseAmount'
          }
        ],
        credit: [
          {
            account: 'Revaluation Surplus (Equity)',
            amount: 'revaluation.increaseAmount'
          }
        ]
      },
      
      decrease: {
        debit: [
          {
            account: 'Revaluation Loss (Expense)',
            amount: 'revaluation.decreaseAmount'
          }
        ],
        credit: [
          {
            account: 'Fixed Assets - [Category]',
            amount: 'revaluation.decreaseAmount'
          }
        ]
      }
    };
    
    // 5. ุงูุจูุน
    disposal: {
      // ุนูุณ ูููุฉ ุงูุฃุตู
      step1_removeAsset: {
        debit: [
          {
            account: 'Accumulated Depreciation',
            amount: 'asset.accumulatedDepreciation'
          }
        ],
        credit: [
          {
            account: 'Fixed Assets',
            amount: 'asset.originalCost'
          }
        ]
      },
      
      // ุชุณุฌูู ุงูุจูุน
      step2_recordSale: {
        debit: [
          {
            account: 'Cash' | 'Accounts Receivable',
            amount: 'disposal.salePrice'
          }
        ],
        credit: [
          {
            account: 'Gain on Sale (if gain)',
            amount: 'disposal.gain'
          }
        ]
      },
      
      // ุฃู ุชุณุฌูู ุงูุฎุณุงุฑุฉ
      step2_recordLoss: {
        debit: [
          {
            account: 'Loss on Sale',
            amount: 'disposal.loss'
          },
          {
            account: 'Cash' | 'Accounts Receivable',
            amount: 'disposal.salePrice'
          }
        ]
      }
    };
    
    // 6. ุงูุชุฎุฑูุฏ
    writeOff: {
      debit: [
        {
          account: 'Accumulated Depreciation',
          amount: 'asset.accumulatedDepreciation'
        },
        {
          account: 'Loss on Write-off',
          amount: 'asset.netBookValue'
        }
      ],
      credit: [
        {
          account: 'Fixed Assets',
          amount: 'asset.originalCost'
        }
      ]
    }
  };
  
  // ุงูุชุฃุซูุฑ ุนูู ุงูููุงุฆู ุงููุงููุฉ
  financialStatements: {
    balanceSheet: {
      assets: {
        nonCurrentAssets: {
          fixedAssets: 'SUM(assets.cost)',
          lessAccumulatedDepreciation: '-SUM(assets.accumulatedDepreciation)',
          netFixedAssets: 'fixedAssets + lessAccumulatedDepreciation'
        }
      },
      
      equity: {
        revaluationSurplus: 'SUM(revaluations.surplusAmount)'
      }
    };
    
    incomeStatement: {
      expenses: {
        depreciationExpense: 'SUM(depreciation.amount)',
        maintenanceExpense: 'SUM(maintenance.cost where not capital)',
        gainLossOnDisposal: 'SUM(disposal.gainLoss)'
      }
    };
    
    cashFlow: {
      operatingActivities: {
        depreciationAddBack: 'SUM(depreciation.amount)'
      },
      investingActivities: {
        purchaseOfFixedAssets: '-SUM(acquisition.cost)',
        proceedsFromSale: 'SUM(disposal.salePrice)'
      }
    }
  };
}
```

### 5.3 ุงูุชูุงูู ูุน ูุฏููู ุงููุฎุฒูู

```typescript
interface InventoryIntegration {
  // ูุทุน ุงูุบูุงุฑ ููุตูุงูุฉ
  maintenanceParts: {
    onMaintenanceOrder: {
      // ุญุฌุฒ ูุทุน ุงูุบูุงุฑ
      reserveItems: async (maintenance) => {
        for (const part of maintenance.parts) {
          await inventoryService.reserve({
            productId: part.productId,
            quantity: part.quantity,
            warehouseId: maintenance.warehouseId,
            referenceType: 'Maintenance',
            referenceId: maintenance.id
          });
        }
      }
    };
    
    onMaintenanceComplete: {
      // ุตุฑู ูุทุน ุงูุบูุงุฑ
      issueItems: async (maintenance) => {
        const transaction = await inventoryService.issue({
          transactionType: 'Maintenance Issue',
          warehouseId: maintenance.warehouseId,
          costCenterId: maintenance.asset.costCenterId,
          items: maintenance.parts.map(p => ({
            productId: p.productId,
            quantity: p.quantity,
            unitCost: p.unitCost
          }))
        });
        
        // ุชุญุฏูุซ ุชูููุฉ ุงูุตูุงูุฉ
        await maintenanceService.updateCost(maintenance.id, {
          partsCost: transaction.totalCost
        });
      }
    }
  };
  
  // ุชุชุจุน ุงูุฃุตูู ุฐุงุช ุงูุฑูู ุงูุชุณูุณูู
  serialTracking: {
    // ุฑุจุท ุงูุฃุตู ุจุงูุณูุฑูุงู ููุจุฑ ูู ุงููุฎุฒูู
    onAssetActivation: async (asset) => {
      if (asset.serialNumber) {
        await inventoryService.linkSerialToAsset({
          productId: asset.productId,
          serialNumber: asset.serialNumber,
          assetId: asset.id
        });
      }
    }
  };
}
```

### 5.4 ุงูุชูุงูู ูุน ูุฏููู ุดุฆูู ุงูุนุงูููู (HR)

```typescript
interface HRIntegration {
  // ุชุนููู ุงูุฃุตูู ููููุธููู
  assetCustody: {
    onAssignment: {
      notification: async (asset, employee) => {
        await notificationService.send({
          to: employee.email,
          subject: 'Asset Assignment',
          template: 'asset-custody',
          data: {
            assetName: asset.name,
            assetCode: asset.code,
            serialNumber: asset.serialNumber,
            assignmentDate: new Date(),
            returnDate: asset.expectedReturnDate
          }
        });
      },
      
      document: async (asset, employee) => {
        // ุฅูุดุงุก ูููุฐุฌ ุนูุฏุฉ
        await documentService.generate({
          template: 'custody-form',
          data: { asset, employee },
          requireSignature: true
        });
      }
    };
    
    onEmployeeTermination: {
      // ุงูุชุญูู ูู ุงูุฃุตูู ุงููุนููุฉ
      checkAssignedAssets: async (employee) => {
        const assets = await assetService.getByEmployee(employee.id);
        
        if (assets.length > 0) {
          // ุชูุจูู HR
          await notificationService.send({
            to: 'hr@company.com',
            subject: 'Employee Termination - Assets Check',
            message: `Employee ${employee.name} has ${assets.length} assigned assets that need to be returned.`
          });
          
          // ููุน ุฅุชูุงู ุงูุฅููุงุก ุญุชู ุฅุฑุฌุงุน ุงูุฃุตูู
          return {
            blocked: true,
            reason: 'Assigned assets pending return',
            assets: assets
          };
        }
      }
    }
  };
  
  // ุณุงุฆูู ุงูุฃุณุทูู
  fleetDrivers: {
    vehicleAssignment: {
      onAssign: async (vehicle, driver) => {
        await assetService.update(vehicle.assetId, {
          assignedTo: driver.employeeId,
          assignmentDate: new Date()
        });
      }
    }
  };
}
```

### 5.5 ุงูุชูุงูู ูุน ูุฏููู ุงููุดุงุฑูุน

```typescript
interface ProjectIntegration {
  // ุฃุตูู ุชุญุช ุงูุชุดุบูู
  constructionInProgress: {
    // ุชุฌููุน ุชูุงููู ุงููุดุฑูุน
    accumulateCosts: async (project) => {
      const cip = await assetService.getCIP(project.id);
      
      // ุชูุงููู ูุจุงุดุฑุฉ
      const directCosts = await projectService.getDirectCosts(project.id);
      // ุชูุงููู ุบูุฑ ูุจุงุดุฑุฉ
      const indirectCosts = await projectService.getIndirectCosts(project.id);
      // ุชูุงููู ุงูุชูููู
      const financingCosts = await projectService.getFinancingCosts(project.id);
      
      const totalCost = directCosts + indirectCosts + financingCosts;
      
      await assetService.updateCIP(cip.id, {
        accumulatedCost: totalCost
      });
    };
    
    // ุชุญููู ูุฃุตู ุซุงุจุช ุนูุฏ ุงูุงูุชูุงู
    onProjectComplete: async (project) => {
      const cip = await assetService.getCIP(project.id);
      
      // ุฅูุดุงุก ุงูุฃุตู ุงูุซุงุจุช
      const asset = await assetService.create({
        name: project.name,
        categoryId: project.assetCategoryId,
        acquisitionMethod: 'Transfer from CIP',
        acquisitionDate: new Date(),
        originalCost: cip.accumulatedCost,
        cipId: cip.id,
        projectId: project.id,
        status: 'Active'
      });
      
      // ุจุฏุก ุงูุฅููุงู
      await depreciationService.startDepreciation(asset.id);
      
      // ุงูููุฏ ุงููุญุงุณุจู
      await journalService.post({
        description: `Transfer from CIP - ${project.name}`,
        entries: [
          {
            account: asset.assetAccountId,
            debit: cip.accumulatedCost
          },
          {
            account: cip.cipAccountId,
            credit: cip.accumulatedCost
          }
        ]
      });
      
      // ุชุญุฏูุซ ุญุงูุฉ CIP
      await assetService.updateCIP(cip.id, {
        status: 'Transferred',
        transferredToAssetId: asset.id
      });
    }
  };
  
  // ุชุฎุตูุต ุงูุฃุตูู ูููุดุงุฑูุน
  projectAssets: {
    allocateAsset: async (assetId, projectId) => {
      await assetService.update(assetId, {
        projectId: projectId,
        costCenterId: project.costCenterId
      });
      
      // ุชุญููู ุงูุฅููุงู ูููุดุฑูุน
      await depreciationService.updateAllocation(assetId, {
        costCenterId: project.costCenterId,
        projectId: projectId
      });
    }
  };
}
```

---

<a name="business-rules"></a>
## โ๏ธ 6. ููุงุนุฏ ุงูุนูู (Business Rules)

### 6.1 ููุงุนุฏ ุงูุงูุชูุงุก

```typescript
interface AcquisitionRules {
  // ููุงุนุฏ ุงูุฅูุดุงุก
  creation: {
    requiredFields: ['name', 'categoryId', 'acquisitionDate', 'originalCost'];
    
    codeGeneration: {
      pattern: '{prefix}-{category}-{year}-{sequence}',
      prefix: 'AST',
      sequenceLength: 5,
      example: 'AST-BLD-2025-00001'
    };
    
    validation: {
      acquisitionDate: {
        notFuture: true,
        notBeforeCompanyStartDate: true
      };
      
      originalCost: {
        minimumValue: 0,
        maximumValue: null,
        requireApprovalAbove: 100000
      };
      
      category: {
        mustBeActive: true,
        mustBeLeafNode: true  // ูุง ูููู ุงุฎุชูุงุฑ ูุฆุฉ ุฑุฆูุณูุฉ
      }
    }
  };
  
  // ุทุฑู ุงูุงูุชูุงุก
  acquisitionMethods: {
    purchase: {
      requirePurchaseOrder: false,  // optional
      requireInvoice: true,
      requireSupplier: true,
      
      costComponents: [
        'Invoice Amount',
        'Shipping Cost',
        'Installation Cost',
        'Customs Duty',
        'Other Direct Costs'
      ]
    };
    
    transferFromCIP: {
      requireProject: true,
      requireCIPAsset: true,
      validateCIPCompleted: true,
      
      costCalculation: 'accumulated_cost_from_cip',
      
      onTransfer: {
        closeCIP: true,
        updateProjectStatus: true,
        startDepreciation: true
      }
    };
    
    donation: {
      requireDonationDocument: true,
      valuationMethod: 'fair_market_value',
      requireApproval: true,
      
      accounting: {
        debit: 'Fixed Assets',
        credit: 'Donation Income'
      }
    };
    
    financialLease: {
      requireLeaseAgreement: true,
      calculatePresentValue: true,
      recognizeAsset: true,
      recognizeLiability: true
    }
  };
}
```

### 6.2 ููุงุนุฏ ุงูุฅููุงู

```typescript
interface DepreciationRules {
  // ูุชู ูุจุฏุฃ ุงูุฅููุงู
  depreciationStart: {
    condition: 'asset.status == Active',
    startDate: {
      options: [
        'acquisition_date',
        'first_day_of_next_month',
        'custom_date'
      ],
      default: 'first_day_of_next_month'
    };
    
    proRata: {
      enabled: true,
      calculation: 'days_basis'  // or 'months_basis'
    }
  };
  
  // ุทุฑู ุงูุฅููุงู
  methods: {
    straightLine: {
      formula: '(cost - salvage_value) / useful_life',
      monthlyAmount: 'annual_depreciation / 12',
      
      example: {
        cost: 100000,
        salvageValue: 10000,
        usefulLife: 10,  // years
        annualDepreciation: 9000,  // (100000 - 10000) / 10
        monthlyDepreciation: 750   // 9000 / 12
      }
    };
    
    decliningBalance: {
      formula: 'net_book_value * depreciation_rate',
      doubleDecline: 'rate = 2 / useful_life',
      
      example: {
        cost: 100000,
        rate: 20,  // %
        year1: 20000,  // 100000 * 20%
        year2: 16000,  // 80000 * 20%
        year3: 12800   // 64000 * 20%
      },
      
      switchToStraightLine: {
        when: 'declining_amount < straight_line_amount',
        ensure: 'salvage_value_not_exceeded'
      }
    };
    
    unitsOfProduction: {
      formula: '(cost - salvage_value) * (units_produced / total_units)',
      
      tracking: {
        requireProductionData: true,
        frequency: 'monthly',
        updateDepreciationBasedOnActual: true
      },
      
      example: {
        cost: 100000,
        salvageValue: 10000,
        totalUnits: 100000,  // hours/km/units
        costPerUnit: 0.9,    // (100000 - 10000) / 100000
        month1Units: 500,
        month1Depreciation: 450  // 500 * 0.9
      }
    };
    
    sumOfYearsDigits: {
      formula: '(cost - salvage_value) * (remaining_life / sum_of_years)',
      
      example: {
        cost: 100000,
        salvageValue: 10000,
        usefulLife: 5,
        sumOfYears: 15,  // 5+4+3+2+1
        year1: 30000,    // 90000 * (5/15)
        year2: 24000,    // 90000 * (4/15)
        year3: 18000     // 90000 * (3/15)
      }
    }
  };
  
  // ุงูุฅููุงู ุงูุถุฑูุจู
  taxDepreciation: {
    separateFromAccounting: true,
    useTaxRates: true,
    
    temporaryDifferences: {
      track: true,
      account: 'Deferred Tax Asset/Liability'
    }
  };
  
  // ููุงุนุฏ ุงูุชููู
  stopDepreciation: {
    when: [
      'asset.status == Disposed',
      'asset.status == Sold',
      'asset.netBookValue <= asset.salvageValue',
      'asset.status == Under Maintenance && stopDuringMaintenance == true'
    ]
  };
  
  // ุงูุชุญูู ูู ุงูุตุญุฉ
  validation: {
    notExceedCost: 'accumulated_depreciation <= (cost - salvage_value)',
    notNegativeNBV: 'net_book_value >= salvage_value',
    noDuplicateForPeriod: 'one_depreciation_per_asset_per_period',
    balancedEntries: 'debit_amount == credit_amount'
  };
}
```

### 6.3 ููุงุนุฏ ุงูุตูุงูุฉ

```typescript
interface MaintenanceRules {
  // ุฃููุงุน ุงูุตูุงูุฉ
  maintenanceTypes: {
    preventive: {
      description: 'Scheduled maintenance to prevent failures',
      scheduling: 'automated',
      capitalization: false,  // ูุตุฑูู
      
      triggers: [
        'time_based',      // ูู X ุดููุฑ
        'usage_based',     // ูู X ุณุงุนุงุช/ูู
        'condition_based'  // ุนูุฏ ูุตูู ุดุฑุท ูุนูู
      ]
    };
    
    corrective: {
      description: 'Repair after failure',
      scheduling: 'on_demand',
      
      capitalization: {
        rule: 'if_extends_life_or_improves_capacity',
        threshold: 1000,  // ูุจูุบ ูุนูู
        requireApproval: true
      }
    };
    
    predictive: {
      description: 'Maintenance based on condition monitoring',
      requiresIoT: true,
      useAI: true
    };
    
    emergency: {
      description: 'Urgent unplanned maintenance',
      priority: 'critical',
      immediate: true
    }
  };
  
  // ุฑุณููุฉ ุงูุตูุงูุฉ
  capitalization: {
    criteria: {
      or: [
        {
          type: 'extends_useful_life',
          condition: 'maintenance extends asset useful life'
        },
        {
          type: 'increases_capacity',
          condition: 'maintenance increases production capacity'
        },
        {
          type: 'improves_quality',
          condition: 'maintenance improves output quality'
        },
        {
          type: 'major_overhaul',
          minAmount: 5000,
          condition: 'cost > threshold'
        }
      ]
    };
    
    accounting: {
      capitalize: {
        debit: 'Fixed Assets',
        credit: 'Cash/AP/Inventory',
        
        effect: {
          increaseAssetCost: true,
          recalculateDepreciation: true,
          extendUsefulLife: 'optional'
        }
      };
      
      expense: {
        debit: 'Maintenance Expense',
        credit: 'Cash/AP/Inventory',
        
        effect: {
          noAssetChange: true,
          currentPeriodExpense: true
        }
      }
    }
  };
  
  // ุงูุฌุฏููุฉ ุงูุชููุงุฆูุฉ
  scheduling: {
    preventiveMaintenance: {
      basedonTimeBased: {
        interval: 'months',
        frequency: 3,  // ูู 3 ุฃุดูุฑ
        createWorkOrder: 'auto',
        notifyInAdvance: 7  // days
      };
      
      basedOnUsage: {
        metric: 'hours' | 'kilometers' | 'cycles',
        threshold: 5000,
        trackUsage: true,
        alertWhenNear: 0.9  // 90% of threshold
      }
    }
  };
}
```

### 6.4 ููุงุนุฏ ุงูููู

```typescript
interface TransferRules {
  // ููุงุนุฏ ุงูููู
  transfer: {
    requiredFields: ['fromLocation', 'toLocation', 'transferDate', 'reason'];
    
    validation: {
      assetMustBeActive: true,
      fromLocationNotEqualToLocation: true,
      notUnderMaintenance: true,
      noPendingTransfers: true
    };
    
    approval: {
      requireApproval: true,
      approvalLevels: [
        {
          role: 'Asset Manager',
          condition: 'same_branch'
        },
        {
          role: 'CFO',
          condition: 'different_branch || different_company'
        }
      ]
    };
    
    effects: {
      updateLocation: true,
      updateCostCenter: 'if_different',
      updateCustodian: 'if_specified',
      reallocateDepreciation: true,
      
      notifications: [
        'from_custodian',
        'to_custodian',
        'asset_manager'
      ]
    }
  };
  
  // ุงูููู ุจูู ุงูุดุฑูุงุช
  intercompanyTransfer: {
    requireValuation: true,
    createSaleTransaction: true,
    createPurchaseTransaction: true,
    
    accounting: {
      sellingCompany: {
        removeAsset: true,
        recognizeGainLoss: true
      },
      buyingCompany: {
        recordAsset: true,
        atTransferPrice: true
      }
    }
  };
}
```

### 6.5 ููุงุนุฏ ุฅุนุงุฏุฉ ุงูุชูููู

```typescript
interface RevaluationRules {
  // ูุชู ุชุชู ุฅุนุงุฏุฉ ุงูุชูููู
  when: {
    triggers: [
      'significant_market_change',
      'periodic_review',  // ุณูููุงู ูุซูุงู
      'impairment_indication',
      'pre_sale_assessment'
    ]
  };
  
  // ุทุฑู ุงูุชูููู
  valuationMethods: {
    fairMarketValue: {
      source: 'independent_appraiser',
      required: true
    };
    
    replacementCost: {
      approach: 'current_cost_to_replace'
    };
    
    netRealizableValue: {
      calculation: 'estimated_selling_price - costs_to_sell'
    }
  };
  
  // ุงููุนุงูุฌุฉ ุงููุญุงุณุจูุฉ
  accounting: {
    increase: {
      // ุฒูุงุฏุฉ ุงููููุฉ
      ifFirstTime: {
        debit: 'Fixed Assets',
        credit: 'Revaluation Surplus (OCI)',
        
        effect: {
          increaseAssetCost: true,
          increaseEquity: true,
          recalculateDepreciation: true
        }
      };
      
      ifPreviousDecrease: {
        // ุนูุณ ุงูุฎุณุงุฑุฉ ุงูุณุงุจูุฉ ุฃููุงู
        reverseUpToPreviousLoss: true,
        excessToRevaluationSurplus: true
      }
    };
    
    decrease: {
      // ุชุฎููุถ ุงููููุฉ
      ifPreviousIncrease: {
        // ุชุฎููุถ ูู ูุงุฆุถ ุฅุนุงุฏุฉ ุงูุชูููู ุฃููุงู
        reduceRevaluationSurplus: true,
        excessToExpense: true
      };
      
      ifNoPreviousIncrease: {
        debit: 'Impairment Loss (Expense)',
        credit: 'Fixed Assets',
        
        effect: {
          decreaseAssetCost: true,
          recognizeLoss: true,
          recalculateDepreciation: true
        }
      }
    }
  };
  
  // ุชุฃุซูุฑ ุนูู ุงูุฅููุงู
  depreciationImpact: {
    recalculate: true,
    basis: 'revalued_amount - salvage_value',
    remainingLife: 'unchanged' | 'reassessed',
    prospective: true  // ุชุฃุซูุฑ ูุณุชูุจูู ููุท
  };
}
```

### 6.6 ููุงุนุฏ ุงูุจูุน ูุงูุชุฎูุต

```typescript
interface DisposalRules {
  // ุฃููุงุน ุงูุชุฎูุต
  disposalTypes: {
    sale: {
      requireBuyer: true,
      requireSalePrice: true,
      requireInvoice: true,
      calculateGainLoss: true
    };
    
    scrap: {
      requireScrapValue: false,
      scrapValueUsually: 0,
      requireApproval: true,
      writeOffRemainingValue: true
    };
    
    donation: {
      requireRecipient: true,
      requireValuation: true,
      noProceeds: true
    };
    
    exchange: {
      requireNewAsset: true,
      calculateBootAmount: true,
      fairValueMeasurement: true
    }
  };
  
  // ุงูููุงููุงุช
  approval: {
    required: true,
    levels: [
      {
        role: 'Asset Manager',
        condition: 'nbv < 10000'
      },
      {
        role: 'CFO',
        condition: 'nbv >= 10000 && nbv < 100000'
      },
      {
        role: 'Board',
        condition: 'nbv >= 100000'
      }
    ]
  };
  
  // ูุจู ุงูุจูุน
  preDisposal: {
    checks: [
      'no_pending_maintenance',
      'clear_custody',
      'remove_from_insurance',
      'settle_any_liens'
    ];
    
    stopDepreciation: {
      at: 'disposal_date',
      calculateFinalDepreciation: true
    }
  };
  
  // ุญุณุงุจ ุงูุฑุจุญ/ุงูุฎุณุงุฑุฉ
  gainLossCalculation: {
    formula: 'sale_price - net_book_value',
    
    netBookValue: 'original_cost - accumulated_depreciation',
    
    example: {
      originalCost: 100000,
      accumulatedDepreciation: 60000,
      netBookValue: 40000,
      salePrice: 45000,
      gain: 5000  // 45000 - 40000
    }
  };
  
  // ุงููุนุงูุฌุฉ ุงููุญุงุณุจูุฉ
  accounting: {
    sale: {
      step1_removeCost: {
        debit: 'Accumulated Depreciation - 60,000',
        credit: 'Fixed Assets - 100,000'
      };
      
      step2_recordSale: {
        debit: 'Cash/AR - 45,000',
        // ุงููุฑู ูู ุงูุฑุจุญ/ุงูุฎุณุงุฑุฉ
      };
      
      step3_recognizeGain: {
        credit: 'Gain on Sale - 5,000'
      };
      
      // ุฃู ูู ุญุงูุฉ ุงูุฎุณุงุฑุฉ
      step3_recognizeLoss: {
        debit: 'Loss on Sale - xxx'
      }
    };
    
    writeOff: {
      debit: [
        'Accumulated Depreciation',
        'Loss on Write-off'  // = NBV
      ],
      credit: [
        'Fixed Assets'
      ]
    }
  };
  
  // ูุง ุจุนุฏ ุงูุชุฎูุต
  postDisposal: {
    updateStatus: 'Disposed' | 'Sold',
    archiveRecords: true,
    retainHistory: true,
    removeFromActiveReports: true,
    notifyStakeholders: true
  };
}
```

---

<a name="database"></a>
## ๐๏ธ 7. Database Schema

### 7.1 ุงูุฌุฏุงูู ุงูุฃุณุงุณูุฉ

```sql
-- ุฌุฏูู ูุฆุงุช ุงูุฃุตูู
CREATE TABLE AssetCategories (
    Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    Code NVARCHAR(50) NOT NULL,
    NameAr NVARCHAR(200) NOT NULL,
    NameEn NVARCHAR(200) NOT NULL,
    
    ParentCategoryId UNIQUEIDENTIFIER,
    Level INT NOT NULL DEFAULT 0,
    Path NVARCHAR(500), -- ููุจุญุซ ุงููุฑูู
    
    Description NVARCHAR(1000),
    
    -- ุฅุนุฏุงุฏุงุช ุงูุฅููุงู ุงูุงูุชุฑุงุถูุฉ
    DefaultDepreciationMethod NVARCHAR(50) CHECK (DefaultDepreciationMethod IN ('Straight Line', 'Declining Balance', 'Units of Production', 'Sum of Years Digits')),
    DefaultUsefulLife INT, -- ุจุงูุณููุงุช
    DefaultUsefulLifeMonths INT,
    DefaultDepreciationRate DECIMAL(5,2),
    DefaultSalvageValuePercentage DECIMAL(5,2),
    
    -- ุงูุฅููุงู ุงูุถุฑูุจู
    TaxDepreciationMethod NVARCHAR(50),
    TaxUsefulLife INT,
    TaxDepreciationRate DECIMAL(5,2),
    
    -- ุงูุญุณุงุจุงุช ุงููุญุงุณุจูุฉ
    AssetAccountId UNIQUEIDENTIFIER,
    DepreciationAccountId UNIQUEIDENTIFIER,
    AccumulatedDepreciationAccountId UNIQUEIDENTIFIER,
    DisposalAccountId UNIQUEIDENTIFIER,
    GainOnDisposalAccountId UNIQUEIDENTIFIER,
    LossOnDisposalAccountId UNIQUEIDENTIFIER,
    
    IsActive BIT DEFAULT 1,
    DisplayOrder INT,
    
    -- Audit
    TenantId UNIQUEIDENTIFIER NOT NULL,
    CreatedAt DATETIME2 DEFAULT GETUTCDATE(),
    CreatedBy UNIQUEIDENTIFIER,
    UpdatedAt DATETIME2 DEFAULT GETUTCDATE(),
    UpdatedBy UNIQUEIDENTIFIER,
    IsDeleted BIT DEFAULT 0,
    
    FOREIGN KEY (ParentCategoryId) REFERENCES AssetCategories(Id),
    FOREIGN KEY (AssetAccountId) REFERENCES ChartOfAccounts(Id),
    FOREIGN KEY (DepreciationAccountId) REFERENCES ChartOfAccounts(Id),
    FOREIGN KEY (AccumulatedDepreciationAccountId) REFERENCES ChartOfAccounts(Id),
    
    INDEX IX_AssetCategories_Parent (ParentCategoryId),
    UNIQUE INDEX UX_AssetCategories_Code (TenantId, Code, IsDeleted)
);

-- ุฌุฏูู ุงูุฃุตูู
CREATE TABLE Assets (
    Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    Code NVARCHAR(50) NOT NULL,
    NameAr NVARCHAR(200) NOT NULL,
    NameEn NVARCHAR(200) NOT NULL,
    Description NVARCHAR(1000),
    
    -- ุงูุชุตููู
    CategoryId UNIQUEIDENTIFIER NOT NULL,
    TypeId UNIQUEIDENTIFIER,
    
    -- ูุนูููุงุช ุงูููุชุฌ
    SerialNumber NVARCHAR(100),
    Barcode NVARCHAR(100),
    RFIDTag NVARCHAR(100),
    Manufacturer NVARCHAR(200),
    Model NVARCHAR(200),
    YearOfManufacture INT,
    
    -- ุงููููุน ูุงูุชุนููู
    CompanyId UNIQUEIDENTIFIER NOT NULL,
    BranchId UNIQUEIDENTIFIER,
    DepartmentId UNIQUEIDENTIFIER,
    LocationId UNIQUEIDENTIFIER,
    RoomNumber NVARCHAR(50),
    
    AssignedTo UNIQUEIDENTIFIER, -- Employee
    Custodian UNIQUEIDENTIFIER, -- Employee
    AssignmentDate DATE,
    
    -- ุงูุงูุชูุงุก
    AcquisitionMethod NVARCHAR(50) NOT NULL CHECK (AcquisitionMethod IN ('Purchase', 'Transfer from CIP', 'Donation', 'Lease', 'Exchange')),
    AcquisitionDate DATE NOT NULL,
    
    SupplierId UNIQUEIDENTIFIER,
    PurchaseOrderId UNIQUEIDENTIFIER,
    PurchaseInvoiceId UNIQUEIDENTIFIER,
    CIPAssetId UNIQUEIDENTIFIER, -- ุฅุฐุง ูุงู ูุญูู ูู CIP
    ProjectId UNIQUEIDENTIFIER,
    
    -- ุงูุชูููุฉ
    Currency NVARCHAR(3) NOT NULL DEFAULT 'SAR',
    ExchangeRate DECIMAL(18,6) DEFAULT 1,
    OriginalCost DECIMAL(18,2) NOT NULL,
    AdditionalCosts DECIMAL(18,2) DEFAULT 0,
    TotalCost AS (OriginalCost + AdditionalCosts) PERSISTED,
    
    -- ุงููููุฉ ุงูุญุงููุฉ
    AccumulatedDepreciation DECIMAL(18,2) DEFAULT 0,
    NetBookValue AS (TotalCost - AccumulatedDepreciation) PERSISTED,
    FairMarketValue DECIMAL(18,2),
    SalvageValue DECIMAL(18,2) DEFAULT 0,
    
    -- ุงูุฅููุงู
    Depreciable BIT DEFAULT 1,
    DepreciationMethod NVARCHAR(50),
    UsefulLife INT, -- ุจุงูุณููุงุช
    UsefulLifeMonths INT,
    DepreciationRate DECIMAL(5,2),
    DepreciationStartDate DATE,
    
    -- ุงูุฅููุงู ุงูุถุฑูุจู
    UseTaxDepreciation BIT DEFAULT 0,
    TaxDepreciationMethod NVARCHAR(50),
    TaxUsefulLife INT,
    TaxDepreciationRate DECIMAL(5,2),
    
    -- ูุญุฏุงุช ุงูุฅูุชุงุฌ (ููุฅููุงู)
    TotalUnitsToDepreciate DECIMAL(18,3),
    UnitsDepreciatedToDate DECIMAL(18,3) DEFAULT 0,
    
    -- ุงูุญุณุงุจุงุช ุงููุญุงุณุจูุฉ
    AssetAccountId UNIQUEIDENTIFIER,
    DepreciationAccountId UNIQUEIDENTIFIER,
    AccumulatedDepreciationAccountId UNIQUEIDENTIFIER,
    CostCenterId UNIQUEIDENTIFIER,
    
    -- ุงูุถูุงู ูุงูุชุฃููู
    WarrantyStartDate DATE,
    WarrantyEndDate DATE,
    InsurancePolicyNumber NVARCHAR(100),
    InsuranceExpiry DATE,
    InsuredValue DECIMAL(18,2),
    
    -- ุงูุญุงูุฉ
    Status NVARCHAR(50) NOT NULL DEFAULT 'Draft' CHECK (Status IN ('Draft', 'Under Construction', 'Active', 'Under Maintenance', 'Disposed', 'Sold', 'Written Off')),
    Condition NVARCHAR(50) CHECK (Condition IN ('Excellent', 'Good', 'Fair', 'Poor', 'Critical')),
    
    -- ุงูุชุฎูุต
    DisposalDate DATE,
    DisposalMethod NVARCHAR(50),
    DisposalPrice DECIMAL(18,2),
    GainLossOnDisposal DECIMAL(18,2),
    
    Notes NVARCHAR(MAX),
    
    -- Audit
    TenantId UNIQUEIDENTIFIER NOT NULL,
    CreatedAt DATETIME2 DEFAULT GETUTCDATE(),
    CreatedBy UNIQUEIDENTIFIER,
    UpdatedAt DATETIME2 DEFAULT GETUTCDATE(),
    UpdatedBy UNIQUEIDENTIFIER,
    IsDeleted BIT DEFAULT 0,
    
    FOREIGN KEY (CategoryId) REFERENCES AssetCategories(Id),
    FOREIGN KEY (CompanyId) REFERENCES Companies(Id),
    FOREIGN KEY (BranchId) REFERENCES Branches(Id),
    FOREIGN KEY (LocationId) REFERENCES Locations(Id),
    FOREIGN KEY (SupplierId) REFERENCES Suppliers(Id),
    FOREIGN KEY (CostCenterId) REFERENCES CostCenters(Id),
    FOREIGN KEY (ProjectId) REFERENCES Projects(Id),
    FOREIGN KEY (AssetAccountId) REFERENCES ChartOfAccounts(Id),
    
    INDEX IX_Assets_Category (CategoryId),
    INDEX IX_Assets_Company (CompanyId),
    INDEX IX_Assets_Status (Status),
    INDEX IX_Assets_SerialNumber (SerialNumber),
    INDEX IX_Assets_Barcode (Barcode),
    UNIQUE INDEX UX_Assets_Code (TenantId, CompanyId, Code, IsDeleted)
);

-- ุฌุฏูู ุฃุตูู ุชุญุช ุงูุชุดุบูู (CIP)
CREATE TABLE AssetsUnderConstruction (
    Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    Code NVARCHAR(50) NOT NULL,
    NameAr NVARCHAR(200) NOT NULL,
    NameEn NVARCHAR(200) NOT NULL,
    Description NVARCHAR(1000),
    
    ProjectId UNIQUEIDENTIFIER,
    CategoryId UNIQUEIDENTIFIER NOT NULL,
    
    CompanyId UNIQUEIDENTIFIER NOT NULL,
    BranchId UNIQUEIDENTIFIER,
    
    StartDate DATE NOT NULL,
    EstimatedCompletionDate DATE,
    ActualCompletionDate DATE,
    
    -- ุงูุชูุงููู ุงููุชุฑุงููุฉ
    AccumulatedCost DECIMAL(18,2) DEFAULT 0,
    DirectCosts DECIMAL(18,2) DEFAULT 0,
    IndirectCosts DECIMAL(18,2) DEFAULT 0,
    FinancingCosts DECIMAL(18,2) DEFAULT 0,
    
    CIPAccountId UNIQUEIDENTIFIER,
    
    Status NVARCHAR(50) NOT NULL DEFAULT 'In Progress' CHECK (Status IN ('In Progress', 'Completed', 'Transferred', 'Cancelled')),
    
    -- ุนูุฏ ุงูุชุญููู
    TransferredToAssetId UNIQUEIDENTIFIER,
    TransferredDate DATE,
    
    Notes NVARCHAR(MAX),
    
    -- Audit
    TenantId UNIQUEIDENTIFIER NOT NULL,
    CreatedAt DATETIME2 DEFAULT GETUTCDATE(),
    CreatedBy UNIQUEIDENTIFIER,
    UpdatedAt DATETIME2 DEFAULT GETUTCDATE(),
    UpdatedBy UNIQUEIDENTIFIER,
    IsDeleted BIT DEFAULT 0,
    
    FOREIGN KEY (ProjectId) REFERENCES Projects(Id),
    FOREIGN KEY (CategoryId) REFERENCES AssetCategories(Id),
    FOREIGN KEY (CompanyId) REFERENCES Companies(Id),
    FOREIGN KEY (TransferredToAssetId) REFERENCES Assets(Id),
    
    INDEX IX_CIP_Project (ProjectId),
    INDEX IX_CIP_Status (Status),
    UNIQUE INDEX UX_CIP_Code (TenantId, CompanyId, Code, IsDeleted)
);

-- ุฌุฏูู ุงูุฅููุงู
CREATE TABLE Depreciations (
    Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    
    AssetId UNIQUEIDENTIFIER NOT NULL,
    
    DepreciationPeriod DATE NOT NULL, -- ุฃูู ููู ูู ุงูุดูุฑ
    DepreciationType NVARCHAR(50) NOT NULL CHECK (DepreciationType IN ('Accounting', 'Tax')),
    
    DepreciationMethod NVARCHAR(50) NOT NULL,
    
    -- ุงูููู ูู ุจุฏุงูุฉ ุงููุชุฑุฉ
    OpeningCost DECIMAL(18,2) NOT NULL,
    OpeningAccumulatedDepreciation DECIMAL(18,2) NOT NULL,
    OpeningNetBookValue DECIMAL(18,2) NOT NULL,
    
    -- ุงูุฅููุงู ูููุชุฑุฉ
    DepreciationAmount DECIMAL(18,2) NOT NULL,
    
    -- ูุญุฏุงุช ุงูุฅูุชุงุฌ
    UnitsProduced DECIMAL(18,3),
    
    -- ุงูููู ูู ููุงูุฉ ุงููุชุฑุฉ
    ClosingAccumulatedDepreciation DECIMAL(18,2) NOT NULL,
    ClosingNetBookValue DECIMAL(18,2) NOT NULL,
    
    IsFullyDepreciated BIT DEFAULT 0,
    
    -- ุงูุชุฑุญูู
    Posted BIT DEFAULT 0,
    PostedAt DATETIME2,
    PostedBy UNIQUEIDENTIFIER,
    JournalEntryId UNIQUEIDENTIFIER,
    
    -- ุงูุนูุณ
    IsReversed BIT DEFAULT 0,
    ReversedAt DATETIME2,
    ReversedBy UNIQUEIDENTIFIER,
    ReversalReason NVARCHAR(500),
    
    Notes NVARCHAR(500),
    
    -- Audit
    TenantId UNIQUEIDENTIFIER NOT NULL,
    CompanyId UNIQUEIDENTIFIER NOT NULL,
    CreatedAt DATETIME2 DEFAULT GETUTCDATE(),
    CreatedBy UNIQUEIDENTIFIER,
    
    FOREIGN KEY (AssetId) REFERENCES Assets(Id),
    FOREIGN KEY (JournalEntryId) REFERENCES JournalEntries(Id),
    
    INDEX IX_Depreciations_Asset (AssetId),
    INDEX IX_Depreciations_Period (DepreciationPeriod),
    INDEX IX_Depreciations_Posted (Posted),
    UNIQUE INDEX UX_Depreciations (TenantId, AssetId, DepreciationPeriod, DepreciationType, IsReversed)
);

-- ุฌุฏูู ุฏูุนุงุช ุงูุฅููุงู
CREATE TABLE DepreciationBatches (
    Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    BatchNumber NVARCHAR(50) NOT NULL,
    
    DepreciationPeriod DATE NOT NULL,
    DepreciationType NVARCHAR(50) NOT NULL,
    
    TotalAssets INT NOT NULL,
    TotalDepreciation DECIMAL(18,2) NOT NULL,
    
    Status NVARCHAR(50) NOT NULL DEFAULT 'Draft' CHECK (Status IN ('Draft', 'Calculated', 'Posted', 'Reversed')),
    
    CalculatedAt DATETIME2,
    CalculatedBy UNIQUEIDENTIFIER,
    
    Posted BIT DEFAULT 0,
    PostedAt DATETIME2,
    PostedBy UNIQUEIDENTIFIER,
    
    Notes NVARCHAR(1000),
    
    -- Audit
    TenantId UNIQUEIDENTIFIER NOT NULL,
    CompanyId UNIQUEIDENTIFIER NOT NULL,
    CreatedAt DATETIME2 DEFAULT GETUTCDATE(),
    CreatedBy UNIQUEIDENTIFIER,
    
    INDEX IX_DepreciationBatches_Period (DepreciationPeriod),
    UNIQUE INDEX UX_DepreciationBatches (TenantId, CompanyId, BatchNumber)
);

-- ุฌุฏูู ุงูุตูุงูุฉ
CREATE TABLE AssetMaintenances (
    Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    Code NVARCHAR(50) NOT NULL,
    
    AssetId UNIQUEIDENTIFIER NOT NULL,
    
    MaintenanceType NVARCHAR(50) NOT NULL CHECK (MaintenanceType IN ('Preventive', 'Corrective', 'Predictive', 'Emergency')),
    Priority NVARCHAR(50) CHECK (Priority IN ('Low', 'Medium', 'High', 'Critical')),
    
    ScheduledDate DATETIME2,
    ActualStartDate DATETIME2,
    ActualEndDate DATETIME2,
    
    Description NVARCHAR(1000) NOT NULL,
    ProblemDescription NVARCHAR(1000),
    WorkPerformed NVARCHAR(MAX),
    
    -- ุงูุชุนููู
    AssignedTo UNIQUEIDENTIFIER,
    AssignedTeam UNIQUEIDENTIFIER,
    RequestedBy UNIQUEIDENTIFIER,
    ApprovedBy UNIQUEIDENTIFIER,
    
    -- ุงูุชูุงููู
    PartsCost DECIMAL(18,2) DEFAULT 0,
    LaborCost DECIMAL(18,2) DEFAULT 0,
    ExternalServiceCost DECIMAL(18,2) DEFAULT 0,
    TransportationCost DECIMAL(18,2) DEFAULT 0,
    OtherCosts DECIMAL(18,2) DEFAULT 0,
    TotalCost AS (PartsCost + LaborCost + ExternalServiceCost + TransportationCost + OtherCosts) PERSISTED,
    
    -- ุงูุฑุณููุฉ
    IsCapitalized BIT DEFAULT 0,
    CapitalizationReason NVARCHAR(500),
    
    -- ุงูุญุงูุฉ
    Status NVARCHAR(50) NOT NULL DEFAULT 'Draft' CHECK (Status IN ('Draft', 'Scheduled', 'In Progress', 'Completed', 'Cancelled')),
    CompletionPercentage DECIMAL(5,2) DEFAULT 0,
    
    -- ุงูุชุฑุญูู
    Posted BIT DEFAULT 0,
    PostedAt DATETIME2,
    PostedBy UNIQUEIDENTIFIER,
    JournalEntryId UNIQUEIDENTIFIER,
    
    -- ุงูุตูุงูุฉ ุงููุชูุฑุฑุฉ
    IsRecurring BIT DEFAULT 0,
    Frequency NVARCHAR(50),
    Interval INT,
    NextMaintenanceDate DATE,
    
    Notes NVARCHAR(MAX),
    
    -- Audit
    TenantId UNIQUEIDENTIFIER NOT NULL,
    CompanyId UNIQUEIDENTIFIER NOT NULL,
    CreatedAt DATETIME2 DEFAULT GETUTCDATE(),
    CreatedBy UNIQUEIDENTIFIER,
    UpdatedAt DATETIME2 DEFAULT GETUTCDATE(),
    UpdatedBy UNIQUEIDENTIFIER,
    IsDeleted BIT DEFAULT 0,
    
    FOREIGN KEY (AssetId) REFERENCES Assets(Id),
    FOREIGN KEY (JournalEntryId) REFERENCES JournalEntries(Id),
    
    INDEX IX_Maintenances_Asset (AssetId),
    INDEX IX_Maintenances_ScheduledDate (ScheduledDate),
    INDEX IX_Maintenances_Status (Status),
    UNIQUE INDEX UX_Maintenances_Code (TenantId, CompanyId, Code, IsDeleted)
);

-- ุฌุฏูู ูุทุน ุบูุงุฑ ุงูุตูุงูุฉ
CREATE TABLE AssetMaintenanceParts (
    Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    MaintenanceId UNIQUEIDENTIFIER NOT NULL,
    LineNumber INT NOT NULL,
    
    ProductId UNIQUEIDENTIFIER NOT NULL,
    Quantity DECIMAL(18,3) NOT NULL,
    UnitId UNIQUEIDENTIFIER NOT NULL,
    UnitCost DECIMAL(18,2) NOT NULL,
    TotalCost DECIMAL(18,2) NOT NULL,
    
    WarehouseId UNIQUEIDENTIFIER,
    
    Notes NVARCHAR(500),
    
    CreatedAt DATETIME2 DEFAULT GETUTCDATE(),
    
    FOREIGN KEY (MaintenanceId) REFERENCES AssetMaintenances(Id),
    FOREIGN KEY (ProductId) REFERENCES Products(Id),
    FOREIGN KEY (UnitId) REFERENCES Units(Id),
    
    INDEX IX_MaintenanceParts_Maintenance (MaintenanceId)
);

-- ุฌุฏูู ุฃูุฏู ุนุงููุฉ ุงูุตูุงูุฉ
CREATE TABLE AssetMaintenanceLabor (
    Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    MaintenanceId UNIQUEIDENTIFIER NOT NULL,
    LineNumber INT NOT NULL,
    
    EmployeeId UNIQUEIDENTIFIER NOT NULL,
    Hours DECIMAL(5,2) NOT NULL,
    HourlyRate DECIMAL(18,2) NOT NULL,
    TotalCost DECIMAL(18,2) NOT NULL,
    
    WorkDate DATE,
    
    Notes NVARCHAR(500),
    
    CreatedAt DATETIME2 DEFAULT GETUTCDATE(),
    
    FOREIGN KEY (MaintenanceId) REFERENCES AssetMaintenances(Id),
    FOREIGN KEY (EmployeeId) REFERENCES Employees(Id),
    
    INDEX IX_MaintenanceLabor_Maintenance (MaintenanceId)
);

-- ุฌุฏูู ููู ุงูุฃุตูู
CREATE TABLE AssetTransfers (
    Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    Code NVARCHAR(50) NOT NULL,
    
    AssetId UNIQUEIDENTIFIER NOT NULL,
    TransferDate DATE NOT NULL,
    
    -- ูู
    FromCompanyId UNIQUEIDENTIFIER,
    FromBranchId UNIQUEIDENTIFIER,
    FromLocationId UNIQUEIDENTIFIER,
    FromCustodian UNIQUEIDENTIFIER,
    
    -- ุฅูู
    ToCompanyId UNIQUEIDENTIFIER,
    ToBranchId UNIQUEIDENTIFIER,
    ToLocationId UNIQUEIDENTIFIER,
    ToCustodian UNIQUEIDENTIFIER,
    
    Reason NVARCHAR(500),
    
    -- ุงูุญุงูุฉ
    Status NVARCHAR(50) NOT NULL DEFAULT 'Draft' CHECK (Status IN ('Draft', 'Pending Approval', 'Approved', 'In Transit', 'Completed', 'Cancelled')),
    
    RequestedBy UNIQUEIDENTIFIER,
    ApprovedBy UNIQUEIDENTIFIER,
    ApprovedAt DATETIME2,
    
    CompletedAt DATETIME2,
    CompletedBy UNIQUEIDENTIFIER,
    
    Notes NVARCHAR(1000),
    
    -- Audit
    TenantId UNIQUEIDENTIFIER NOT NULL,
    CreatedAt DATETIME2 DEFAULT GETUTCDATE(),
    CreatedBy UNIQUEIDENTIFIER,
    UpdatedAt DATETIME2 DEFAULT GETUTCDATE(),
    UpdatedBy UNIQUEIDENTIFIER,
    IsDeleted BIT DEFAULT 0,
    
    FOREIGN KEY (AssetId) REFERENCES Assets(Id),
    FOREIGN KEY (FromCompanyId) REFERENCES Companies(Id),
    FOREIGN KEY (ToCompanyId) REFERENCES Companies(Id),
    
    INDEX IX_Transfers_Asset (AssetId),
    INDEX IX_Transfers_Date (TransferDate),
    UNIQUE INDEX UX_Transfers_Code (TenantId, Code, IsDeleted)
);

-- ุฌุฏูู ุฅุนุงุฏุฉ ุชูููู ุงูุฃุตูู
CREATE TABLE AssetRevaluations (
    Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    Code NVARCHAR(50) NOT NULL,
    
    AssetId UNIQUEIDENTIFIER NOT NULL,
    RevaluationDate DATE NOT NULL,
    
    -- ุงูููู ูุจู ุฅุนุงุฏุฉ ุงูุชูููู
    PreviousCost DECIMAL(18,2) NOT NULL,
    PreviousAccumulatedDepreciation DECIMAL(18,2) NOT NULL,
    PreviousNetBookValue DECIMAL(18,2) NOT NULL,
    
    -- ุงููููุฉ ุงูุฌุฏูุฏุฉ
    RevaluedAmount DECIMAL(18,2) NOT NULL,
    
    -- ุงููุฑู
    RevaluationDifference DECIMAL(18,2) NOT NULL,
    IsIncrease BIT NOT NULL,
    
    -- ุทุฑููุฉ ุงูุชูููู
    ValuationMethod NVARCHAR(50),
    Appraiser NVARCHAR(200),
    AppraisalReportNumber NVARCHAR(100),
    
    Reason NVARCHAR(500),
    
    -- ุงูุญุงูุฉ
    Status NVARCHAR(50) NOT NULL DEFAULT 'Draft' CHECK (Status IN ('Draft', 'Pending Approval', 'Approved', 'Posted', 'Cancelled')),
    
    ApprovedBy UNIQUEIDENTIFIER,
    ApprovedAt DATETIME2,
    
    Posted BIT DEFAULT 0,
    PostedAt DATETIME2,
    PostedBy UNIQUEIDENTIFIER,
    JournalEntryId UNIQUEIDENTIFIER,
    
    Notes NVARCHAR(1000),
    
    -- Audit
    TenantId UNIQUEIDENTIFIER NOT NULL,
    CompanyId UNIQUEIDENTIFIER NOT NULL,
    CreatedAt DATETIME2 DEFAULT GETUTCDATE(),
    CreatedBy UNIQUEIDENTIFIER,
    UpdatedAt DATETIME2 DEFAULT GETUTCDATE(),
    UpdatedBy UNIQUEIDENTIFIER,
    IsDeleted BIT DEFAULT 0,
    
    FOREIGN KEY (AssetId) REFERENCES Assets(Id),
    FOREIGN KEY (JournalEntryId) REFERENCES JournalEntries(Id),
    
    INDEX IX_Revaluations_Asset (AssetId),
    INDEX IX_Revaluations_Date (RevaluationDate),
    UNIQUE INDEX UX_Revaluations_Code (TenantId, CompanyId, Code, IsDeleted)
);

-- ุฌุฏูู ุงูุชุฎูุต ูู ุงูุฃุตูู
CREATE TABLE AssetDisposals (
    Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    Code NVARCHAR(50) NOT NULL,
    
    AssetId UNIQUEIDENTIFIER NOT NULL,
    DisposalDate DATE NOT NULL,
    
    DisposalMethod NVARCHAR(50) NOT NULL CHECK (DisposalMethod IN ('Sale', 'Scrap', 'Donation', 'Exchange', 'Write Off')),
    
    -- ุงูููู ุนูุฏ ุงูุชุฎูุต
    AssetCost DECIMAL(18,2) NOT NULL,
    AccumulatedDepreciation DECIMAL(18,2) NOT NULL,
    NetBookValue DECIMAL(18,2) NOT NULL,
    
    -- ุงูุชุฎูุต
    DisposalPrice DECIMAL(18,2) DEFAULT 0,
    DisposalCosts DECIMAL(18,2) DEFAULT 0,
    NetProceeds AS (DisposalPrice - DisposalCosts) PERSISTED,
    
    -- ุงูุฑุจุญ/ุงูุฎุณุงุฑุฉ
    GainLoss AS (DisposalPrice - DisposalCosts - NetBookValue) PERSISTED,
    IsGain AS (CASE WHEN (DisposalPrice - DisposalCosts - NetBookValue) > 0 THEN 1 ELSE 0 END) PERSISTED,
    
    -- ูุนูููุงุช ุงููุดุชุฑู/ุงููุชููู
    BuyerName NVARCHAR(200),
    BuyerTaxNumber NVARCHAR(50),
    SalesInvoiceId UNIQUEIDENTIFIER,
    
    Reason NVARCHAR(500),
    
    -- ุงูุญุงูุฉ
    Status NVARCHAR(50) NOT NULL DEFAULT 'Draft' CHECK (Status IN ('Draft', 'Pending Approval', 'Approved', 'Posted', 'Cancelled')),
    
    ApprovedBy UNIQUEIDENTIFIER,
    ApprovedAt DATETIME2,
    
    Posted BIT DEFAULT 0,
    PostedAt DATETIME2,
    PostedBy UNIQUEIDENTIFIER,
    JournalEntryId UNIQUEIDENTIFIER,
    
    Notes NVARCHAR(1000),
    
    -- Audit
    TenantId UNIQUEIDENTIFIER NOT NULL,
    CompanyId UNIQUEIDENTIFIER NOT NULL,
    CreatedAt DATETIME2 DEFAULT GETUTCDATE(),
    CreatedBy UNIQUEIDENTIFIER,
    UpdatedAt DATETIME2 DEFAULT GETUTCDATE(),
    UpdatedBy UNIQUEIDENTIFIER,
    IsDeleted BIT DEFAULT 0,
    
    FOREIGN KEY (AssetId) REFERENCES Assets(Id),
    FOREIGN KEY (JournalEntryId) REFERENCES JournalEntries(Id),
    
    INDEX IX_Disposals_Asset (AssetId),
    INDEX IX_Disposals_Date (DisposalDate),
    UNIQUE INDEX UX_Disposals_Code (TenantId, CompanyId, Code, IsDeleted)
);

-- ุฌุฏูู ุงููุณุชูุฏุงุช ุงููุฑููุฉ
CREATE TABLE AssetDocuments (
    Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    AssetId UNIQUEIDENTIFIER NOT NULL,
    
    DocumentType NVARCHAR(100) NOT NULL,
    FileName NVARCHAR(500) NOT NULL,
    FileUrl NVARCHAR(1000) NOT NULL,
    FileSize BIGINT,
    MimeType NVARCHAR(100),
    
    Category NVARCHAR(100),
    Description NVARCHAR(500),
    
    UploadedAt DATETIME2 DEFAULT GETUTCDATE(),
    UploadedBy UNIQUEIDENTIFIER,
    
    IsDeleted BIT DEFAULT 0,
    
    FOREIGN KEY (AssetId) REFERENCES Assets(Id),
    INDEX IX_AssetDocuments_Asset (AssetId)
);

-- ุฌุฏูู ุชุงุฑูุฎ ุงูุฃุตูู (Audit Trail)
CREATE TABLE AssetHistory (
    Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    AssetId UNIQUEIDENTIFIER NOT NULL,
    
    TransactionDate DATETIME2 NOT NULL DEFAULT GETUTCDATE(),
    TransactionType NVARCHAR(100) NOT NULL,
    
    Description NVARCHAR(1000),
    
    -- ุงูููู ูุจู ูุจุนุฏ
    OldValue NVARCHAR(MAX),
    NewValue NVARCHAR(MAX),
    
    Amount DECIMAL(18,2),
    
    ReferenceType NVARCHAR(100),
    ReferenceId UNIQUEIDENTIFIER,
    
    PerformedBy UNIQUEIDENTIFIER,
    
    TenantId UNIQUEIDENTIFIER NOT NULL,
    
    FOREIGN KEY (AssetId) REFERENCES Assets(Id),
    INDEX IX_AssetHistory_Asset (AssetId),
    INDEX IX_AssetHistory_Date (TransactionDate)
);

-- ุฌุฏูู ุฌุฑุฏ ุงูุฃุตูู
CREATE TABLE AssetPhysicalCounts (
    Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    Code NVARCHAR(50) NOT NULL,
    
    CountDate DATE NOT NULL,
    CompanyId UNIQUEIDENTIFIER NOT NULL,
    BranchId UNIQUEIDENTIFIER,
    LocationId UNIQUEIDENTIFIER,
    
    Description NVARCHAR(500),
    
    Status NVARCHAR(50) NOT NULL DEFAULT 'Draft' CHECK (Status IN ('Draft', 'In Progress', 'Completed', 'Approved', 'Posted')),
    
    CountedBy UNIQUEIDENTIFIER,
    ApprovedBy UNIQUEIDENTIFIER,
    ApprovedAt DATETIME2,
    
    Notes NVARCHAR(1000),
    
    -- Audit
    TenantId UNIQUEIDENTIFIER NOT NULL,
    CreatedAt DATETIME2 DEFAULT GETUTCDATE(),
    CreatedBy UNIQUEIDENTIFIER,
    UpdatedAt DATETIME2 DEFAULT GETUTCDATE(),
    UpdatedBy UNIQUEIDENTIFIER,
    IsDeleted BIT DEFAULT 0,
    
    INDEX IX_PhysicalCounts_Date (CountDate),
    UNIQUE INDEX UX_PhysicalCounts_Code (TenantId, CompanyId, Code, IsDeleted)
);

-- ุฌุฏูู ุชูุงุตูู ุงูุฌุฑุฏ
CREATE TABLE AssetPhysicalCountLines (
    Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    PhysicalCountId UNIQUEIDENTIFIER NOT NULL,
    
    AssetId UNIQUEIDENTIFIER NOT NULL,
    
    ExpectedLocation UNIQUEIDENTIFIER,
    ActualLocation UNIQUEIDENTIFIER,
    
    ExpectedCustodian UNIQUEIDENTIFIER,
    ActualCustodian UNIQUEIDENTIFIER,
    
    ExpectedCondition NVARCHAR(50),
    ActualCondition NVARCHAR(50),
    
    Found BIT NOT NULL,
    ConditionChanged BIT DEFAULT 0,
    LocationChanged BIT DEFAULT 0,
    CustodianChanged BIT DEFAULT 0,
    
    Remarks NVARCHAR(500),
    
    CountedAt DATETIME2,
    CountedBy UNIQUEIDENTIFIER,
    
    FOREIGN KEY (PhysicalCountId) REFERENCES AssetPhysicalCounts(Id),
    FOREIGN KEY (AssetId) REFERENCES Assets(Id),
    
    INDEX IX_PhysicalCountLines_Count (PhysicalCountId)
);
```

---

<a name="apis"></a>
## ๐ 8. APIs ุงููุทููุจุฉ

### 8.1 Asset APIs

```typescript
// GET /api/v1/assets
GET /api/v1/assets?page=1&pageSize=20&categoryId=&status=Active&search=

// GET /api/v1/assets/{id}
GET /api/v1/assets/550e8400-e29b-41d4-a716-446655440000

// POST /api/v1/assets
POST /api/v1/assets
{
  "code": "AST-BLD-2025-00001",
  "nameAr": "ูุจูู ุงูููุงุชุจ ุงูุฑุฆูุณู",
  "nameEn": "Main Office Building",
  "categoryId": "guid",
  "acquisitionMethod": "Purchase",
  "acquisitionDate": "2025-10-01",
  "originalCost": 5000000,
  "supplierId": "guid",
  "depreciationMethod": "Straight Line",
  "usefulLife": 25
}

// PUT /api/v1/assets/{id}
PUT /api/v1/assets/550e8400-e29b-41d4-a716-446655440000

// DELETE /api/v1/assets/{id}
DELETE /api/v1/assets/550e8400-e29b-41d4-a716-446655440000

// POST /api/v1/assets/{id}/activate
POST /api/v1/assets/550e8400-e29b-41d4-a716-446655440000/activate

// POST /api/v1/assets/{id}/assign
POST /api/v1/assets/550e8400-e29b-41d4-a716-446655440000/assign
{
  "assignedTo": "employee-guid",
  "assignmentDate": "2025-10-06"
}

// GET /api/v1/assets/{id}/history
GET /api/v1/assets/550e8400-e29b-41d4-a716-446655440000/history

// GET /api/v1/assets/{id}/depreciation-schedule
GET /api/v1/assets/550e8400-e29b-41d4-a716-446655440000/depreciation-schedule
```

### 8.2 Asset Category APIs

```typescript
// GET /api/v1/asset-categories (tree structure)
GET /api/v1/asset-categories?hierarchical=true

// GET /api/v1/asset-categories/{id}
GET /api/v1/asset-categories/{id}

// POST /api/v1/asset-categories
POST /api/v1/asset-categories
{
  "code": "CAT-001",
  "nameAr": "ุงููุจุงูู",
  "nameEn": "Buildings",
  "parentCategoryId": null,
  "defaultDepreciationMethod": "Straight Line",
  "defaultUsefulLife": 25,
  "assetAccountId": "guid"
}

// PUT /api/v1/asset-categories/{id}
PUT /api/v1/asset-categories/{id}

// DELETE /api/v1/asset-categories/{id}
DELETE /api/v1/asset-categories/{id}
```

### 8.3 CIP (Construction in Progress) APIs

```typescript
// GET /api/v1/assets-under-construction
GET /api/v1/assets-under-construction?status=In Progress

// GET /api/v1/assets-under-construction/{id}
GET /api/v1/assets-under-construction/{id}

// POST /api/v1/assets-under-construction
POST /api/v1/assets-under-construction
{
  "code": "CIP-2025-001",
  "nameAr": "ูุดุฑูุน ูุจูู ุงููุฑุน ุงูุฌุฏูุฏ",
  "projectId": "guid",
  "categoryId": "guid",
  "startDate": "2025-01-01",
  "estimatedCompletionDate": "2025-12-31"
}

// POST /api/v1/assets-under-construction/{id}/add-cost
POST /api/v1/assets-under-construction/{id}/add-cost
{
  "costType": "Direct" | "Indirect" | "Financing",
  "amount": 50000,
  "description": "Construction materials",
  "referenceId": "invoice-guid"
}

// POST /api/v1/assets-under-construction/{id}/transfer-to-asset
POST /api/v1/assets-under-construction/{id}/transfer-to-asset
{
  "transferDate": "2025-10-01",
  "assetCategoryId": "guid",
  "depreciationMethod": "Straight Line",
  "usefulLife": 25
}

// GET /api/v1/assets-under-construction/{id}/cost-breakdown
GET /api/v1/assets-under-construction/{id}/cost-breakdown
```

### 8.4 Depreciation APIs

```typescript
// POST /api/v1/depreciation/calculate-batch
POST /api/v1/depreciation/calculate-batch
{
  "period": "2025-10-01",
  "depreciationType": "Accounting",
  "categoryIds": ["guid1", "guid2"],
  "branchIds": ["guid1"],
  "includeNewAssets": true
}

Response: {
  "batchId": "guid",
  "totalAssets": 150,
  "totalDepreciation": 125000,
  "assets": [...]
}

// POST /api/v1/depreciation/post-batch
POST /api/v1/depreciation/post-batch/{batchId}

// POST /api/v1/depreciation/reverse
POST /api/v1/depreciation/reverse/{depreciationId}
{
  "reason": "Calculation error"
}

// GET /api/v1/depreciation/history
GET /api/v1/depreciation/history?assetId=guid&from=2025-01-01&to=2025-12-31

// GET /api/v1/depreciation/schedule
GET /api/v1/depreciation/schedule/{assetId}

// POST /api/v1/depreciation/recalculate
POST /api/v1/depreciation/recalculate/{assetId}
{
  "fromDate": "2025-10-01",
  "reason": "Asset revaluation"
}
```

### 8.5 Maintenance APIs

```typescript
// GET /api/v1/asset-maintenance
GET /api/v1/asset-maintenance?assetId=guid&status=Scheduled

// GET /api/v1/asset-maintenance/{id}
GET /api/v1/asset-maintenance/{id}

// POST /api/v1/asset-maintenance
POST /api/v1/asset-maintenance
{
  "assetId": "guid",
  "maintenanceType": "Preventive",
  "priority": "Medium",
  "scheduledDate": "2025-10-15T09:00:00Z",
  "description": "Annual preventive maintenance",
  "assignedTo": "technician-guid"
}

// PUT /api/v1/asset-maintenance/{id}
PUT /api/v1/asset-maintenance/{id}

// POST /api/v1/asset-maintenance/{id}/start
POST /api/v1/asset-maintenance/{id}/start

// POST /api/v1/asset-maintenance/{id}/complete
POST /api/v1/asset-maintenance/{id}/complete
{
  "actualEndDate": "2025-10-15T15:30:00Z",
  "workPerformed": "Replaced oil and filters, checked all systems",
  "parts": [...],
  "labor": [...],
  "isCapitalized": false
}

// POST /api/v1/asset-maintenance/{id}/post
POST /api/v1/asset-maintenance/{id}/post

// GET /api/v1/asset-maintenance/schedule
GET /api/v1/asset-maintenance/schedule?from=2025-10-01&to=2025-10-31

// POST /api/v1/asset-maintenance/schedule-recurring
POST /api/v1/asset-maintenance/schedule-recurring
{
  "assetId": "guid",
  "maintenanceType": "Preventive",
  "frequency": "Monthly",
  "interval": 3,
  "startDate": "2025-10-01",
  "description": "Quarterly maintenance"
}
```

### 8.6 Transfer APIs

```typescript
// POST /api/v1/asset-transfers
POST /api/v1/asset-transfers
{
  "assetId": "guid",
  "transferDate": "2025-10-10",
  "fromLocationId": "guid",
  "toLocationId": "guid",
  "toCustodian": "employee-guid",
  "reason": "Department relocation"
}

// POST /api/v1/asset-transfers/{id}/approve
POST /api/v1/asset-transfers/{id}/approve

// POST /api/v1/asset-transfers/{id}/complete
POST /api/v1/asset-transfers/{id}/complete
{
  "completedDate": "2025-10-10",
  "notes": "Transfer completed successfully"
}

// POST /api/v1/asset-transfers/{id}/cancel
POST /api/v1/asset-transfers/{id}/cancel
```

### 8.7 Revaluation APIs

```typescript
// POST /api/v1/asset-revaluations
POST /api/v1/asset-revaluations
{
  "assetId": "guid",
  "revaluationDate": "2025-10-01",
  "revaluedAmount": 4500000,
  "valuationMethod": "Fair Market Value",
  "appraiser": "ABC Appraisal Company",
  "reason": "Market value increase"
}

// POST /api/v1/asset-revaluations/{id}/approve
POST /api/v1/asset-revaluations/{id}/approve

// POST /api/v1/asset-revaluations/{id}/post
POST /api/v1/asset-revaluations/{id}/post
```

### 8.8 Disposal APIs

```typescript
// POST /api/v1/asset-disposals
POST /api/v1/asset-disposals
{
  "assetId": "guid",
  "disposalDate": "2025-10-15",
  "disposalMethod": "Sale",
  "disposalPrice": 150000,
  "buyerName": "XYZ Company",
  "reason": "Upgrading to new equipment"
}

// POST /api/v1/asset-disposals/{id}/approve
POST /api/v1/asset-disposals/{id}/approve

// POST /api/v1/asset-disposals/{id}/post
POST /api/v1/asset-disposals/{id}/post

// GET /api/v1/asset-disposals/{id}/gain-loss-calculation
GET /api/v1/asset-disposals/{id}/gain-loss-calculation
```

### 8.9 Physical Count APIs

```typescript
// POST /api/v1/asset-physical-counts
POST /api/v1/asset-physical-counts
{
  "countDate": "2025-10-20",
  "branchId": "guid",
  "locationId": "guid",
  "description": "Annual asset verification"
}

// POST /api/v1/asset-physical-counts/{id}/add-assets
POST /api/v1/asset-physical-counts/{id}/add-assets
{
  "assetIds": ["guid1", "guid2", "guid3"]
}

// PUT /api/v1/asset-physical-counts/{id}/lines/{lineId}
PUT /api/v1/asset-physical-counts/{id}/lines/{lineId}
{
  "found": true,
  "actualLocation": "guid",
  "actualCondition": "Good",
  "remarks": "Asset found in good condition"
}

// POST /api/v1/asset-physical-counts/{id}/complete
POST /api/v1/asset-physical-counts/{id}/complete

// POST /api/v1/asset-physical-counts/{id}/approve
POST /api/v1/asset-physical-counts/{id}/approve

// GET /api/v1/asset-physical-counts/{id}/discrepancies
GET /api/v1/asset-physical-counts/{id}/discrepancies
```

---

<a name="examples"></a>
## ๐ 9. ุงูุฃูุซูุฉ ุงูุนูููุฉ

### ูุซุงู 1: ุฏูุฑุฉ ุญูุงุฉ ุฃุตู ูุงููุฉ (ุดุฑุงุก โ ุชุดุบูู โ ุจูุน)

#### ุงูุฎุทูุฉ 1: ุดุฑุงุก ุงูุฃุตู

```http
POST /api/v1/assets
{
  "code": "AST-VEH-2025-00001",
  "nameAr": "ุณูุงุฑุฉ ุชูููุชุง ูุงูุฑู 2025",
  "nameEn": "Toyota Camry 2025",
  "description": "Company vehicle for sales manager",
  "categoryId": "vehicles-category-guid",
  "serialNumber": "VIN123456789",
  "manufacturer": "Toyota",
  "model": "Camry GLX",
  "yearOfManufacture": 2025,
  
  "companyId": "company-guid",
  "branchId": "riyadh-branch-guid",
  "departmentId": "sales-dept-guid",
  
  "acquisitionMethod": "Purchase",
  "acquisitionDate": "2025-10-01",
  "supplierId": "toyota-dealer-guid",
  "purchaseInvoiceId": "invoice-guid",
  
  "originalCost": 120000,
  "additionalCosts": 5000,
  
  "depreciable": true,
  "depreciationMethod": "Declining Balance",
  "usefulLife": 5,
  "depreciationRate": 40,
  "salvageValue": 20000,
  "depreciationStartDate": "2025-11-01",
  
  "assetAccountId": "1310-vehicles-guid",
  "depreciationAccountId": "5210-depreciation-expense-guid",
  "accumulatedDepreciationAccountId": "1311-accumulated-dep-guid",
  "costCenterId": "sales-cc-guid",
  
  "warrantyStartDate": "2025-10-01",
  "warrantyEndDate": "2028-10-01",
  "insurancePolicyNumber": "INS-2025-456",
  "insuranceExpiry": "2026-10-01",
  
  "status": "Draft"
}

Response: 201 Created
{
  "id": "asset-001",
  "code": "AST-VEH-2025-00001",
  "totalCost": 125000,
  "status": "Draft"
}
```

#### ุงูุฎุทูุฉ 2: ุชูุนูู ุงูุฃุตู

```http
POST /api/v1/assets/asset-001/activate

Response: 200 OK
{
  "status": "Active",
  "activatedAt": "2025-10-01T10:00:00Z",
  "depreciationStartDate": "2025-11-01",
  "accountingEntry": {
    "description": "Asset Acquisition - Toyota Camry",
    "entries": [
      {
        "account": "1310 - Vehicles",
        "debit": 125000
      },
      {
        "account": "2110 - Accounts Payable",
        "credit": 125000
      }
    ]
  }
}
```

#### ุงูุฎุทูุฉ 3: ุชุนููู ุงูุฃุตู ูููุธู

```http
POST /api/v1/assets/asset-001/assign
{
  "assignedTo": "employee-ahmed-guid",
  "custodian": "employee-ahmed-guid",
  "assignmentDate": "2025-10-01"
}

Response: 200 OK
{
  "assigned": true,
  "assignedTo": {
    "id": "employee-ahmed-guid",
    "name": "Ahmed Mohammed"
  },
  "custodyDocument": {
    "documentId": "custody-doc-001",
    "url": "/documents/custody-forms/asset-001.pdf",
    "requiresSignature": true
  }
}
```

#### ุงูุฎุทูุฉ 4: ุงูุฅููุงู ุงูุดูุฑู (ุชููุงุฆู)

```http
// ูุชู ุชุดุบููู ูู ููุงูุฉ ูู ุดูุฑ ุชููุงุฆูุงู
POST /api/v1/depreciation/calculate-batch
{
  "period": "2025-11-01",
  "depreciationType": "Accounting",
  "categoryIds": ["vehicles-category-guid"]
}

Response: 200 OK
{
  "batchId": "dep-batch-202511",
  "totalAssets": 1,
  "totalDepreciation": 4166.67,
  "assets": [
    {
      "assetId": "asset-001",
      "assetCode": "AST-VEH-2025-00001",
      "method": "Declining Balance",
      "openingCost": 125000,
      "openingAccumulatedDepreciation": 0,
      "openingNetBookValue": 125000,
      "depreciationAmount": 4166.67,  // (125000 * 40%) / 12
      "closingAccumulatedDepreciation": 4166.67,
      "closingNetBookValue": 120833.33
    }
  ]
}

// ุชุฑุญูู ุงูุฅููุงู
POST /api/v1/depreciation/post-batch/dep-batch-202511

Response: 200 OK
{
  "posted": true,
  "journalEntry": {
    "description": "Depreciation for November 2025",
    "entries": [
      {
        "account": "5210 - Depreciation Expense",
        "debit": 4166.67,
        "costCenter": "sales-cc-guid"
      },
      {
        "account": "1311 - Accumulated Depreciation - Vehicles",
        "credit": 4166.67
      }
    ]
  }
}
```

#### ุงูุฎุทูุฉ 5: ุตูุงูุฉ ุฏูุฑูุฉ

```http
POST /api/v1/asset-maintenance
{
  "assetId": "asset-001",
  "maintenanceType": "Preventive",
  "priority": "Medium",
  "scheduledDate": "2025-12-15T09:00:00Z",
  "description": "10,000 KM service - oil change and inspection",
  "assignedTo": "technician-guid"
}

Response: 201 Created
{
  "id": "maintenance-001",
  "code": "MNT-2025-001",
  "status": "Scheduled"
}

// ุฅูุฌุงุฒ ุงูุตูุงูุฉ
POST /api/v1/asset-maintenance/maintenance-001/complete
{
  "actualEndDate": "2025-12-15T11:30:00Z",
  "workPerformed": "- Oil and filter change\n- Tire rotation\n- Brake inspection\n- All systems checked",
  "parts": [
    {
      "productId": "oil-filter-guid",
      "quantity": 1,
      "unitCost": 50,
      "totalCost": 50
    },
    {
      "productId": "engine-oil-guid",
      "quantity": 5,
      "unitCost": 30,
      "totalCost": 150
    }
  ],
  "labor": [
    {
      "employeeId": "technician-guid",
      "hours": 2,
      "hourlyRate": 100,
      "totalCost": 200
    }
  ],
  "externalServiceCost": 0,
  "otherCosts": 50,
  "isCapitalized": false
}

Response: 200 OK
{
  "status": "Completed",
  "totalCost": 450,
  "breakdown": {
    "parts": 200,
    "labor": 200,
    "other": 50
  }
}

// ุชุฑุญูู ุงูุตูุงูุฉ
POST /api/v1/asset-maintenance/maintenance-001/post

Response: 200 OK
{
  "posted": true,
  "journalEntry": {
    "description": "Vehicle Maintenance - AST-VEH-2025-00001",
    "entries": [
      {
        "account": "5310 - Maintenance Expense",
        "debit": 450,
        "costCenter": "sales-cc-guid"
      },
      {
        "account": "1410 - Inventory",
        "credit": 200
      },
      {
        "account": "1010 - Cash",
        "credit": 250
      }
    ]
  }
}
```

#### ุงูุฎุทูุฉ 6: ุจูุน ุงูุฃุตู ุจุนุฏ 3 ุณููุงุช

```http
// ุฃููุงู: ุญุณุงุจ ุงูุฅููุงู ุงููุชุฑุงูู ุจุนุฏ 3 ุณููุงุช
GET /api/v1/assets/asset-001

Response:
{
  "originalCost": 125000,
  "accumulatedDepreciation": 76800,  // ุจุนุฏ 3 ุณููุงุช
  "netBookValue": 48200,
  "currentCondition": "Good"
}

// ุฅูุดุงุก ุนูููุฉ ุงูุจูุน
POST /api/v1/asset-disposals
{
  "assetId": "asset-001",
  "disposalDate": "2028-10-01",
  "disposalMethod": "Sale",
  "disposalPrice": 55000,
  "disposalCosts": 1000,
  "buyerName": "Mohammed Ali",
  "buyerTaxNumber": "300123456789",
  "reason": "Upgrading fleet"
}

Response: 201 Created
{
  "id": "disposal-001",
  "code": "DSP-2028-001",
  "assetCost": 125000,
  "accumulatedDepreciation": 76800,
  "netBookValue": 48200,
  "disposalPrice": 55000,
  "disposalCosts": 1000,
  "netProceeds": 54000,
  "gainLoss": 5800,  // 54000 - 48200
  "isGain": true,
  "status": "Draft"
}

// ุงูููุงููุฉ
POST /api/v1/asset-disposals/disposal-001/approve

// ุงูุชุฑุญูู
POST /api/v1/asset-disposals/disposal-001/post

Response: 200 OK
{
  "posted": true,
  "journalEntry": {
    "description": "Asset Disposal - Sale of Toyota Camry",
    "entries": [
      {
        "account": "1010 - Cash",
        "debit": 54000
      },
      {
        "account": "1311 - Accumulated Depreciation - Vehicles",
        "debit": 76800
      },
      {
        "account": "1310 - Vehicles",
        "credit": 125000
      },
      {
        "account": "4510 - Gain on Asset Sale",
        "credit": 5800
      }
    ]
  },
  "assetStatus": "Sold"
}
```

---

### ูุซุงู 2: ุชุญููู ูู ุฃุตูู ุชุญุช ุงูุชุดุบูู (CIP)

#### ุงูุฎุทูุฉ 1: ุฅูุดุงุก ูุดุฑูุน CIP

```http
POST /api/v1/assets-under-construction
{
  "code": "CIP-2025-001",
  "nameAr": "ูุดุฑูุน ูุจูู ุงููุฑุน ุงูุฌุฏูุฏ - ุฌุฏุฉ",
  "nameEn": "New Branch Building Project - Jeddah",
  "description": "Construction of new 5-story office building",
  "projectId": "project-jeddah-building-guid",
  "categoryId": "buildings-category-guid",
  "companyId": "company-guid",
  "branchId": "jeddah-branch-guid",
  "startDate": "2025-01-01",
  "estimatedCompletionDate": "2026-06-30",
  "cipAccountId": "1320-cip-buildings-guid"
}

Response: 201 Created
{
  "id": "cip-001",
  "code": "CIP-2025-001",
  "status": "In Progress",
  "accumulatedCost": 0
}
```

#### ุงูุฎุทูุฉ 2: ุฅุถุงูุฉ ุชูุงููู ูููุดุฑูุน (ุนูู ูุฏุงุฑ ุงูุณูุฉ)

```http
// ุชูููุฉ ูุจุงุดุฑุฉ - ููุงุฏ ุจูุงุก
POST /api/v1/assets-under-construction/cip-001/add-cost
{
  "costType": "Direct",
  "amount": 500000,
  "description": "Construction materials - Phase 1",
  "referenceType": "PurchaseInvoice",
  "referenceId": "invoice-001-guid"
}

// ุชูููุฉ ูุจุงุดุฑุฉ - ุนูุงูุฉ
POST /api/v1/assets-under-construction/cip-001/add-cost
{
  "costType": "Direct",
  "amount": 300000,
  "description": "Labor costs - Q1 2025",
  "referenceType": "PayrollBatch",
  "referenceId": "payroll-q1-guid"
}

// ุชูููุฉ ุบูุฑ ูุจุงุดุฑุฉ - ุฅุดุฑุงู ููุฏุณู
POST /api/v1/assets-under-construction/cip-001/add-cost
{
  "costType": "Indirect",
  "amount": 50000,
  "description": "Engineering supervision",
  "referenceType": "Expense",
  "referenceId": "expense-001-guid"
}

// ุชูููุฉ ุชูููู - ููุงุฆุฏ ุงููุฑุถ
POST /api/v1/assets-under-construction/cip-001/add-cost
{
  "costType": "Financing",
  "amount": 25000,
  "description": "Interest on construction loan - Q1",
  "referenceType": "JournalEntry",
  "referenceId": "je-interest-guid"
}

// ุงูุญุตูู ุนูู ููุฎุต ุงูุชูุงููู
GET /api/v1/assets-under-construction/cip-001/cost-breakdown

Response:
{
  "cipId": "cip-001",
  "code": "CIP-2025-001",
  "status": "In Progress",
  "costBreakdown": {
    "directCosts": 3500000,
    "indirectCosts": 350000,
    "financingCosts": 150000,
    "totalAccumulatedCost": 4000000
  },
  "timeline": {
    "startDate": "2025-01-01",
    "estimatedCompletion": "2026-06-30",
    "progressPercentage": 75
  }
}
```

#### ุงูุฎุทูุฉ 3: ุงูุชูุงู ุงููุดุฑูุน ูุงูุชุญููู ูุฃุตู ุซุงุจุช

```http
POST /api/v1/assets-under-construction/cip-001/transfer-to-asset
{
  "transferDate": "2026-06-30",
  "actualCompletionDate": "2026-06-30",
  "assetCategoryId": "buildings-category-guid",
  "depreciationMethod": "Straight Line",
  "usefulLife": 25,
  "salvageValue": 400000,
  "depreciationStartDate": "2026-07-01"
}

Response: 200 OK
{
  "cipStatus": "Transferred",
  "newAsset": {
    "id": "asset-building-001",
    "code": "AST-BLD-2026-00001",
    "nameAr": "ูุจูู ุงููุฑุน ุงูุฌุฏูุฏ - ุฌุฏุฉ",
    "totalCost": 4000000,
    "categoryId": "buildings-category-guid",
    "status": "Active",
    "depreciationStartDate": "2026-07-01",
    "annualDepreciation": 144000,  // (4000000 - 400000) / 25
    "monthlyDepreciation": 12000
  },
  "journalEntry": {
    "description": "Transfer from CIP to Fixed Asset - Jeddah Building",
    "entries": [
      {
        "account": "1300 - Buildings",
        "debit": 4000000
      },
      {
        "account": "1320 - CIP - Buildings",
        "credit": 4000000
      }
    ]
  }
}
```

---

### ูุซุงู 3: ุฅุนุงุฏุฉ ุชูููู ุฃุตู

```http
POST /api/v1/asset-revaluations
{
  "assetId": "asset-building-001",
  "revaluationDate": "2027-07-01",
  "revaluedAmount": 4500000,
  "valuationMethod": "Fair Market Value",
  "appraiser": "Professional Valuation Company",
  "appraisalReportNumber": "VAL-2027-789",
  "reason": "Significant increase in real estate market value"
}

Response: 201 Created
{
  "id": "revaluation-001",
  "code": "RVL-2027-001",
  "previousCost": 4000000,
  "previousAccumulatedDepreciation": 144000,  // ุณูุฉ ูุงุญุฏุฉ
  "previousNetBookValue": 3856000,
  "revaluedAmount": 4500000,
  "revaluationDifference": 644000,  // 4500000 - 3856000
  "isIncrease": true,
  "status": "Draft"
}

// ุงูููุงููุฉ ูุงูุชุฑุญูู
POST /api/v1/asset-revaluations/revaluation-001/approve
POST /api/v1/asset-revaluations/revaluation-001/post

Response: 200 OK
{
  "posted": true,
  "journalEntry": {
    "description": "Asset Revaluation - Jeddah Building",
    "entries": [
      {
        "account": "1300 - Buildings",
        "debit": 644000
      },
      {
        "account": "3510 - Revaluation Surplus (OCI)",
        "credit": 644000
      }
    ]
  },
  "depreciationImpact": {
    "newBasis": 4500000,
    "salvageValue": 400000,
    "remainingLife": 24,  // years
    "newAnnualDepreciation": 170833.33,  // (4500000 - 400000) / 24
    "previousAnnualDepreciation": 144000,
    "increase": 26833.33
  }
}
```

---

### ูุซุงู 4: ุตูุงูุฉ ุฑุฃุณูุงููุฉ (ุชุถุงู ููุฃุตู)

```http
POST /api/v1/asset-maintenance
{
  "assetId": "asset-building-001",
  "maintenanceType": "Corrective",
  "priority": "High",
  "scheduledDate": "2028-03-01T08:00:00Z",
  "description": "Major HVAC system upgrade and roof replacement",
  "assignedTeam": "maintenance-team-guid"
}

Response: 201 Created
{
  "id": "maintenance-major-001",
  "code": "MNT-2028-045",
  "status": "Draft"
}

// ุฅุชูุงู ุงูุตูุงูุฉ
POST /api/v1/asset-maintenance/maintenance-major-001/complete
{
  "actualEndDate": "2028-03-15T17:00:00Z",
  "workPerformed": "Complete HVAC system replacement with high-efficiency units. Full roof membrane replacement.",
  "parts": [
    {
      "productId": "hvac-unit-guid",
      "quantity": 10,
      "unitCost": 15000,
      "totalCost": 150000
    },
    {
      "productId": "roofing-material-guid",
      "quantity": 1,
      "unitCost": 80000,
      "totalCost": 80000
    }
  ],
  "labor": [
    {
      "employeeId": "team-lead-guid",
      "hours": 120,
      "hourlyRate": 150,
      "totalCost": 18000
    }
  ],
  "externalServiceCost": 50000,
  "otherCosts": 12000,
  "isCapitalized": true,
  "capitalizationReason": "This upgrade significantly extends the building's useful life and improves energy efficiency"
}

Response: 200 OK
{
  "status": "Completed",
  "totalCost": 310000,
  "isCapitalized": true
}

// ุงูุชุฑุญูู
POST /api/v1/asset-maintenance/maintenance-major-001/post

Response: 200 OK
{
  "posted": true,
  "journalEntry": {
    "description": "Capitalized Maintenance - Building Upgrade",
    "entries": [
      {
        "account": "1300 - Buildings",
        "debit": 310000
      },
      {
        "account": "1410 - Inventory",
        "credit": 230000
      },
      {
        "account": "1010 - Cash",
        "credit": 80000
      }
    ]
  },
  "assetUpdated": {
    "previousCost": 4500000,
    "capitalizedAmount": 310000,
    "newCost": 4810000,
    "depreciationRecalculated": true,
    "newAnnualDepreciation": 184583.33
  }
}
```

---

### ูุซุงู 5: ุฌุฑุฏ ุงูุฃุตูู

```http
// ุฅูุดุงุก ุนูููุฉ ุฌุฑุฏ
POST /api/v1/asset-physical-counts
{
  "countDate": "2026-12-31",
  "companyId": "company-guid",
  "branchId": "riyadh-branch-guid",
  "description": "Annual physical verification of all assets"
}

Response: 201 Created
{
  "id": "count-2026-001",
  "code": "CNT-2026-001",
  "status": "Draft"
}

// ุฅุถุงูุฉ ุงูุฃุตูู ุงููุฑุงุฏ ุฌุฑุฏูุง
POST /api/v1/asset-physical-counts/count-2026-001/add-assets
{
  "assetIds": [
    "asset-001",
    "asset-002",
    "asset-003",
    // ... ุฌููุน ุงูุฃุตูู ูู ุงููุฑุน
  ]
}

// ุงูุจุฏุก ูู ุงูุฌุฑุฏ
POST /api/v1/asset-physical-counts/count-2026-001/start

// ุชุญุฏูุซ ุญุงูุฉ ูู ุฃุตู
PUT /api/v1/asset-physical-counts/count-2026-001/lines/line-001
{
  "found": true,
  "actualLocation": "expected-location-guid",
  "actualCustodian": "expected-custodian-guid",
  "actualCondition": "Good",
  "remarks": "Asset found in expected location and good condition"
}

PUT /api/v1/asset-physical-counts/count-2026-001/lines/line-002
{
  "found": true,
  "actualLocation": "different-location-guid",
  "actualCustodian": "expected-custodian-guid",
  "actualCondition": "Fair",
  "conditionChanged": true,
  "locationChanged": true,
  "remarks": "Asset found in different location. Condition downgraded to Fair due to visible wear."
}

PUT /api/v1/asset-physical-counts/count-2026-001/lines/line-003
{
  "found": false,
  "remarks": "Asset not found during physical count. Further investigation required."
}

// ุงูุญุตูู ุนูู ุงููุนูููุงุช
GET /api/v1/asset-physical-counts/count-2026-001/discrepancies

Response:
{
  "totalAssets": 150,
  "assetsFound": 148,
  "assetsNotFound": 2,
  "locationDiscrepancies": 5,
  "conditionDiscrepancies": 8,
  "custodianDiscrepancies": 3,
  "discrepancies": [
    {
      "assetCode": "AST-VEH-2025-00003",
      "issue": "Not Found",
      "severity": "High"
    },
    {
      "assetCode": "AST-FURN-2024-00045",
      "issue": "Location Changed",
      "expectedLocation": "Office 201",
      "actualLocation": "Office 305",
      "severity": "Medium"
    }
  ]
}

// ุฅููุงู ุงูุฌุฑุฏ
POST /api/v1/asset-physical-counts/count-2026-001/complete

// ุงูููุงููุฉ
POST /api/v1/asset-physical-counts/count-2026-001/approve
```

---

## ๐ 10. ุงูุชูุงุฑูุฑ ุงูุฃุณุงุณูุฉ

### 10.1 ุชูุงุฑูุฑ ุงูุฃุตูู

1. **Asset Register**
   - ุณุฌู ุดุงูู ูุฌููุน ุงูุฃุตูู
   - ุญุณุจ ุงููุฆุฉ/ุงููููุน/ุงูุญุงูุฉ

2. **Asset List by Category**
   - ุชุตููู ุงูุฃุตูู ุญุณุจ ุงููุฆุฉ
   - ูุน ุงูููู ูุงูุฅููุงู

3. **Asset Location Report**
   - ุงูุฃุตูู ุญุณุจ ุงููููุน
   - ูุน ุงููุณุคูู

4. **Asset Custody Report**
   - ุงูุฃุตูู ุงููุนููุฉ ููููุธููู
   - ุนูุฏ ุงูููุธููู

5. **Asset Acquisition Report**
   - ุงูุฃุตูู ุงูููุชูุงุฉ ุฎูุงู ูุชุฑุฉ
   - ุญุณุจ ุทุฑููุฉ ุงูุงูุชูุงุก

6. **Assets Near End of Life**
   - ุงูุฃุตูู ุงููุฑูุจุฉ ูู ููุงูุฉ ุงูุนูุฑ ุงูุฅูุชุงุฌู

7. **Asset Condition Report**
   - ุญุงูุฉ ุงูุฃุตูู
   - ุงูุฃุตูู ุงูุชู ุชุญุชุงุฌ ุตูุงูุฉ

### 10.2 ุชูุงุฑูุฑ ุงูุฅููุงู

1. **Depreciation Schedule**
   - ุฌุฏูู ุงูุฅููุงู ููู ุฃุตู
   - ุงูุฅููุงู ุงููุชููุน

2. **Depreciation Summary**
   - ููุฎุต ุงูุฅููุงู ุงูุดูุฑู/ุงูุณููู
   - ุญุณุจ ุงููุฆุฉ

3. **Fully Depreciated Assets**
   - ุงูุฃุตูู ุงููุณุชูููุฉ ุจุงููุงูู

4. **Depreciation Expense Report**
   - ูุตุฑูู ุงูุฅููุงู ุญุณุจ ูุฑูุฒ ุงูุชูููุฉ

5. **Book vs. Tax Depreciation**
   - ููุงุฑูุฉ ุงูุฅููุงู ุงููุญุงุณุจู ูุงูุถุฑูุจู

### 10.3 ุชูุงุฑูุฑ ุงูุตูุงูุฉ

1. **Maintenance History**
   - ุณุฌู ุงูุตูุงูุฉ ููู ุฃุตู

2. **Maintenance Cost Analysis**
   - ุชุญููู ุชูุงููู ุงูุตูุงูุฉ

3. **Scheduled Maintenance**
   - ุงูุตูุงูุฉ ุงููุฌุฏููุฉ ุงููุงุฏูุฉ

4. **Overdue Maintenance**
   - ุงูุตูุงูุฉ ุงููุชุฃุฎุฑุฉ

5. **Maintenance by Asset Category**
   - ุงูุตูุงูุฉ ุญุณุจ ููุน ุงูุฃุตู

### 10.4 ุงูุชูุงุฑูุฑ ุงููุงููุฉ

1. **Fixed Assets Summary**
   - ููุฎุต ุงูุฃุตูู ุงูุซุงุจุชุฉ
   - ุงูุชูููุฉ ูุงูุฅููุงู ูุงููููุฉ ุงูุฏูุชุฑูุฉ

2. **Asset Movement Report**
   - ุญุฑูุฉ ุงูุฃุตูู ุฎูุงู ูุชุฑุฉ
   - (ุฅุถุงูุงุชุ ุชุฎูุตุ ุชุญูููุงุช)

3. **Gain/Loss on Disposal**
   - ุงูุฃุฑุจุงุญ ูุงูุฎุณุงุฆุฑ ูู ุจูุน ุงูุฃุตูู

4. **Asset Revaluation Report**
   - ุฅุนุงุฏุฉ ุงูุชููููุงุช
   - ุงูุชุฃุซูุฑ ุนูู ุงูููุงุฆู ุงููุงููุฉ

5. **CIP Status Report**
   - ุญุงูุฉ ุงูุฃุตูู ุชุญุช ุงูุชุดุบูู
   - ุงูุชูุงููู ุงููุชุฑุงููุฉ

### 10.5 ุชูุงุฑูุฑ ุงูุฌุฑุฏ

1. **Physical Count Summary**
   - ููุฎุต ุนูููุงุช ุงูุฌุฑุฏ

2. **Asset Discrepancies**
   - ุงููุฑููุงุช ุงูููุชุดูุฉ

3. **Missing Assets Report**
   - ุงูุฃุตูู ุงูููููุฏุฉ

---

## ๐ฏ ุงูุฎูุงุตุฉ ูุงูููุงุท ุงููููุฉ

### ุงูุนูููุงุช ุงูุฃุณุงุณูุฉ
1. โ ุฅุฏุงุฑุฉ ุฏูุฑุฉ ุญูุงุฉ ุงูุฃุตู ุงููุงููุฉ
2. โ ูุธุงู ุฅููุงู ุดุงูู (4 ุทุฑู)
3. โ ุงูุฅููุงู ุงููุญุงุณุจู ูุงูุถุฑูุจู ุงููููุตู
4. โ ุชุญููู CIP ูุฃุตูู ุซุงุจุชุฉ
5. โ ุฅุฏุงุฑุฉ ุงูุตูุงูุฉ (ููุงุฆูุฉ ูุชุตุญูุญูุฉ)
6. โ ุงูุฑุณููุฉ ุงูุฐููุฉ ููุตูุงูุฉ
7. โ ุฅุนุงุฏุฉ ุงูุชูููู
8. โ ุงูุจูุน ูุงูุชุฎูุต

### ุงูุชูุงูู
- ๐ ุชูุงูู ูุน ุงููุดุชุฑูุงุช (ุงูุชูุงุก ุงูุฃุตูู)
- ๐ ุชูุงูู ูุน ุงูุญุณุงุจุงุช (ูููุฏ ุขููุฉ)
- ๐ ุชูุงูู ูุน ุงููุฎุฒูู (ูุทุน ุงูุบูุงุฑ)
- ๐ ุชูุงูู ูุน HR (ุชุนููู ุงูุฃุตูู)
- ๐ ุชูุงูู ูุน ุงููุดุงุฑูุน (CIP)

### ุงูููุฒุงุช ุงููุชูุฏูุฉ
- ๐ฏ 4 ุทุฑู ููุฅููุงู
- ๐ฏ ุงููุทุงุจูุฉ ุงูุซูุงุซูุฉ ููุตูุงูุฉ ุงูุฑุฃุณูุงููุฉ
- ๐ฏ ุงูุชุชุจุน ุจุงูุจุงุฑููุฏ/RFID
- ๐ฏ ุงูุฌุฑุฏ ุงููุนูู
- ๐ฏ ุณุฌู ุชุงุฑูุฎู ูุงูู
- ๐ฏ Multi-Location & Multi-Company

### ุฎุฏูุงุช ูุณุชููุฉ (Services)
- โ๏ธ **Depreciation Service**: ุญุณุงุจ ูุชุฑุญูู ุงูุฅููุงู ุชููุงุฆูุงู
- โ๏ธ **CIP Transfer Service**: ุชุญููู ุงูุฃุตูู ูู CIP
- โ๏ธ **Maintenance Scheduler**: ุฌุฏููุฉ ุงูุตูุงูุฉ ุงูุฏูุฑูุฉ
- โ๏ธ **Asset Tracking Service**: ุชุชุจุน ุงูุฃุตูู ูุงููููุน

---

**ุชู ุฅุนุฏุงุฏ ูุฐุง ุงููุณุชูุฏ ุจูุงุณุทุฉ:** Claude Sonnet 4.5  
**ุงูุชุงุฑูุฎ:** 2025-10-06  
**ุงููุณุฎุฉ:** 1.0  
**ุงูุญุงูุฉ:** โ ููุชูู